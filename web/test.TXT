    "* use this source file for your ABAP unit test classes
"* use this source file for your ABAP unit test classes
CLASS ltc_sd_0051 DEFINITION FOR TESTING DURATION SHORT RISK LEVEL HARMLESS.
  PUBLIC SECTION.
    CLASS-DATA:
      mo_client_proxy      TYPE REF TO /iwbep/if_cp_client_proxy,
      sql_test_environment TYPE REF TO if_osql_test_environment.

  PRIVATE SECTION.
    DATA:
      object_main  TYPE REF TO lhc_zr_sd_0351,
      ls_item_0202 TYPE TABLE OF zsdt0202.

    CLASS-METHODS:
      class_setup RAISING cx_static_check,
      class_teardown.

    METHODS:
      prepare_testdata_set RAISING cx_static_check,
      prepare_testdata_empty RAISING cx_static_check,
      prepare_testdata_item0224empty RAISING cx_static_check,
      prepare_testdata_item0225 RAISING cx_static_check,
      teardown
        RAISING
          /iwbep/cx_gateway
          cx_static_check,
      testcase_01_1 FOR TESTING RAISING cx_static_check,
      testcase_01_2 FOR TESTING RAISING cx_static_check,
      testcase_01_3 FOR TESTING RAISING cx_static_check,
      testcase_01_4 FOR TESTING RAISING cx_static_check,
      testcase_01_5 FOR TESTING RAISING cx_static_check,
      testcase_01_6 FOR TESTING RAISING cx_static_check,
      testcase_01_7 FOR TESTING RAISING cx_static_check,
      testcase_01_8 FOR TESTING RAISING cx_static_check,
      testcase_01_9 FOR TESTING RAISING cx_static_check,
      testcase_01_10 FOR TESTING RAISING cx_static_check,
      testcase_01_11 FOR TESTING RAISING cx_static_check,
      testcase_01_12 FOR TESTING RAISING cx_static_check,
      testcase_01_13 FOR TESTING RAISING cx_static_check,
      testcase_01_14 FOR TESTING RAISING cx_static_check,
      testcase_01_15 FOR TESTING RAISING cx_static_check,
      testcase_01_16 FOR TESTING RAISING cx_static_check,
      testcase_01_17 FOR TESTING RAISING cx_static_check,
      testcase_01_18 FOR TESTING RAISING cx_static_check,
      testcase_01_19 FOR TESTING RAISING cx_static_check,
      testcase_01_20 FOR TESTING RAISING cx_static_check,
      testcase_01_21 FOR TESTING RAISING cx_static_check,
      testcase_01_22 FOR TESTING RAISING cx_static_check,
      testcase_01_23 FOR TESTING RAISING cx_static_check,
      testcase_01_24 FOR TESTING RAISING cx_static_check,
      testcase_01_25 FOR TESTING RAISING cx_static_check,
      testcase_01_26 FOR TESTING RAISING cx_static_check,
      testcase_01_27 FOR TESTING RAISING cx_static_check,
      testcase_01_28 FOR TESTING RAISING cx_static_check,
      testcase_01_29 FOR TESTING RAISING cx_static_check,
      testcase_01_30 FOR TESTING RAISING cx_static_check,
      testcase_01_31 FOR TESTING RAISING cx_static_check,
      testcase_01_32 FOR TESTING RAISING cx_static_check,
      testcase_01_33 FOR TESTING RAISING cx_static_check,
      testcase_01_34 FOR TESTING RAISING cx_static_check,
      testcase_01_35 FOR TESTING RAISING cx_static_check,
      testcase_01_36 FOR TESTING RAISING cx_static_check,
      testcase_01_37 FOR TESTING RAISING cx_static_check,
      testcase_01_38 FOR TESTING RAISING cx_static_check,
      testcase_01_39 FOR TESTING RAISING cx_static_check,
      testcase_01_40 FOR TESTING RAISING cx_static_check,
      testcase_01_41 FOR TESTING RAISING cx_static_check,
      testcase_01_42 FOR TESTING RAISING cx_static_check,
      testcase_01_43 FOR TESTING RAISING cx_static_check,
      testcase_01_44 FOR TESTING RAISING cx_static_check,
      testcase_01_45 FOR TESTING RAISING cx_static_check,
      testcase_01_46 FOR TESTING RAISING cx_static_check,
      testcase_01_47 FOR TESTING RAISING cx_static_check,
      testcase_01_48 FOR TESTING RAISING cx_static_check,
      testcase_01_49 FOR TESTING RAISING cx_static_check,
      testcase_01_50 FOR TESTING RAISING cx_static_check,
      testcase_01_51 FOR TESTING RAISING cx_static_check,
      testcase_01_52 FOR TESTING RAISING cx_static_check,
      testcase_01_53 FOR TESTING RAISING cx_static_check,
      testcase_01_54 FOR TESTING RAISING cx_static_check,
      testcase_01_55 FOR TESTING RAISING cx_static_check,
      testcase_01_56 FOR TESTING RAISING cx_static_check,
      testcase_01_57 FOR TESTING RAISING cx_static_check,
      testcase_01_58 FOR TESTING RAISING cx_static_check,
      testcase_01_59 FOR TESTING RAISING cx_static_check,
      testcase_02_1 FOR TESTING RAISING cx_static_check,
      testcase_02_2 FOR TESTING RAISING cx_static_check,
      testcase_02_3 FOR TESTING RAISING cx_static_check,
      testcase_02_4 FOR TESTING RAISING cx_static_check,
      testcase_02_5 FOR TESTING RAISING cx_static_check,
      testcase_02_6 FOR TESTING RAISING cx_static_check,
      testcase_02_7 FOR TESTING RAISING cx_static_check,
      testcase_02_8 FOR TESTING RAISING cx_static_check,
      testcase_03_1 FOR TESTING RAISING cx_static_check,
      testcase_03_2 FOR TESTING RAISING cx_static_check,
      testcase_03_3 FOR TESTING RAISING cx_static_check,
      testcase_03_4 FOR TESTING RAISING cx_static_check,
      testcase_04_1 FOR TESTING RAISING cx_static_check,
      testcase_04_2 FOR TESTING RAISING cx_static_check,
      testcase_04_3 FOR TESTING RAISING cx_static_check,
      testcase_04_4 FOR TESTING RAISING cx_static_check,
      testcase_05_1 FOR TESTING RAISING cx_static_check,
      testcase_05_2 FOR TESTING RAISING cx_static_check,
      testcase_06_1 FOR TESTING RAISING cx_static_check,
      testcase_06_2 FOR TESTING RAISING cx_static_check,
      testcase_06_3 FOR TESTING RAISING cx_static_check,
      testcase_06_4 FOR TESTING RAISING cx_static_check,
      testcase_06_5 FOR TESTING RAISING cx_static_check,
      testcase_06_6 FOR TESTING RAISING cx_static_check,
      testcase_06_7 FOR TESTING RAISING cx_static_check,
      testcase_06_8 FOR TESTING RAISING cx_static_check,
      testcase_07_1 FOR TESTING RAISING cx_static_check,
      testcase_07_2 FOR TESTING RAISING cx_static_check,
      testcase_07_3 FOR TESTING RAISING cx_static_check,
      testcase_08_1 FOR TESTING RAISING cx_static_check,
      testcase_08_2 FOR TESTING RAISING cx_static_check,
      testcase_08_3 FOR TESTING RAISING cx_static_check,
      testcase_08_4 FOR TESTING RAISING cx_static_check,
      testcase_08_5 FOR TESTING RAISING cx_static_check,
      testcase_08_6 FOR TESTING RAISING cx_static_check,
      testcase_07_4 FOR TESTING RAISING cx_static_check.


ENDCLASS.

CLASS ltc_sd_0051 IMPLEMENTATION.
  METHOD class_setup.
    " SQL Test Environment の作成
    sql_test_environment = cl_osql_test_environment=>create(
      i_dependency_list = VALUE #(
        ( 'ZSDT0225' )
        ( 'ZSDT0224' )
        ( 'ZSDT0202' )
        ( 'ZSDT0210' )
        ( 'ZSDT0210' )
        ( 'ZSDT0217' )
        ( 'ZSDT0284' )
        ( 'makt' )
        ( 'tvkbt' )
      )
      ).

  ENDMETHOD.

  METHOD class_teardown.
    sql_test_environment->destroy( ).
  ENDMETHOD.

  METHOD prepare_testdata_set.
    sql_test_environment->clear_doubles( ).
    CREATE OBJECT object_main FOR TESTING.
    CLEAR:
  object_main->glb_db_0224,
  object_main->glb_db_0225,
  object_main->glb_db_makt,
  object_main->glb_db_tvkbt,
  object_main->glb_it_okb6100,
  object_main->glb_db_0209,
  object_main->glb_startdt,
  object_main->glb_in_bsshkb,
  object_main->glb_it_kabtkb,
  object_main->glb_enddt.

    DATA:
      item_0202  TYPE STANDARD TABLE OF zsdt0202 WITH EMPTY KEY,
      item_0224  TYPE STANDARD TABLE OF zsdt0224 WITH EMPTY KEY,
      item_0210  TYPE STANDARD TABLE OF zsdt0210 WITH EMPTY KEY,
      item_0225  TYPE STANDARD TABLE OF zsdt0225 WITH EMPTY KEY,
      item_0284  TYPE STANDARD TABLE OF zsdt0284 WITH EMPTY KEY,
      item_tvkbt TYPE STANDARD TABLE OF tvkbt WITH EMPTY KEY,
      startdate  TYPE dats,
      enddate    TYPE dats.

    startdate = '20140101'.
    enddate = '20150101'.
    object_main->glb_startdt = startdate.
    object_main->glb_enddt = enddate.

    object_main->glb_db_0209 = VALUE #(
    (
   hdbucd = 'DP1'
   hcbucd = 'DP11130'
   hsbucd = 'DP111301130'
   kabtkb = '08'
   kabtnm = 'OSリング'
   bnrikb = ''
   bunrnm = ''
   zdelflg = ''
    )
    ).

    object_main->glb_db_0224 = VALUE #(
     ( bstpkb = 'A1' bstpnm = '旭　本番用　2014年1月から' frmndt = '201401' tomndt = '000005' bstnkb = '30' bsmrkb = '20' bsmtkb = '10' bsshkb = '10' )

      ).

    object_main->glb_db_0225 = VALUE #(
    ( client = '310'
    bstpkb = 'A1'
    frmndt = '201401'
    bsjkkb = '20'
    bstpsq = '0010'
    bstpnm = '旭　本番用　2018年3月から'
    tomndt = '000000'
    bsspkb = '21'
    rtchkb = 'A'  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
    bsjnkb = '10'  bsjnnm = '配送料DP1：◇構造資材◇'  bsksfg = ''
    obks01 = '55113'  obks02 = 'obks01'  obks03 = 'obks01'  obks04 = 'obks01'  obks05 = 'obks01'
    obks06 = ''  obks07 = ''  obks08 = ''  obks09 = ''  obks10 = ''
    okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = ''
    okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = ''
    bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
    obkrcd = ''  okkrcd = ''  kkrhkb = '08'
    bskart = '0.000'
    zdelflg = '' )
    ( client = '310'
    bstpkb = 'A1'
    frmndt = '201401'
    bsjkkb = '10'
    bstpsq = '0000'
    bstpnm = '旭　本番用　2018年3月から'
    tomndt = '000000'
    rtchkb = 'A'  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
    bsjnkb = '10'  bsjnnm = '配送料DP1：◇構造資材◇'  bsksfg = ''
    obks01 = 'obks01'  obks02 = 'obks01'  obks03 = 'obks01'  obks04 = 'obks01'  obks05 = 'obks01'
    obks06 = ''  obks07 = ''  obks08 = ''  obks09 = ''  obks10 = ''
    okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = ''
    okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = ''
    bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
    obkrcd = ''  okkrcd = ''  kkrhkb = ''
    bskart = '0.000'
    zdelflg = '' )

    ( client = '310'
    bstpkb = 'A1'
    frmndt = '201401'
    bsjkkb = '10'
    bstpsq = '0001'
    bstpnm = '旭　本番用　2018年3月から'
    tomndt = '000000'
    rtchkb = 'A'  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
    bsjnkb = '20'  bsjnnm = '配送料DP1：◇構造資材◇'  bsksfg = ''
    obks01 = 'obks01'  obks02 = 'obks01'  obks03 = 'obks01'  obks04 = 'obks01'  obks05 = 'obks01'
    obks06 = ''  obks07 = ''  obks08 = ''  obks09 = ''  obks10 = ''
    okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = ''
    okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = ''
    bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
    obkrcd = ''  okkrcd = ''  kkrhkb = ''
    bskart = '0.000'
    zdelflg = '' )

    ( client = '310'
    bstpkb = 'A1'
    frmndt = '201401'
    bsjkkb = '10'
    bstpsq = '0002'
    bstpnm = '旭　本番用　2018年3月から'
    tomndt = '000000'
    rtchkb = 'A'  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
    bsjnkb = '30'  bsjnnm = '配送料DP1'  bsksfg = ''
    obks01 = 'obks01'  obks02 = 'obks01'  obks03 = 'obks01'  obks04 = 'obks01'  obks05 = 'obks01'
    obks06 = ''  obks07 = ''  obks08 = ''  obks09 = ''  obks10 = ''
    okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = ''
    okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = ''
    bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
    obkrcd = ''  okkrcd = ''  kkrhkb = ''
    bskart = '0.000'
    zdelflg = '' )

    ( client = '310'
    bstpkb = 'A1'
    frmndt = '201401'
    bsjkkb = '10'
    bstpsq = '0003'
    bstpnm = '旭　本番用　2018年3月から'
    tomndt = '000000'
    rtchkb = 'A'  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
    bsjnkb = '40'  bsjnnm = '配送料DP1：◇構造資材◇'  bsksfg = ''
    obks01 = 'obks01'  obks02 = 'obks01'  obks03 = 'obks01'  obks04 = 'obks01'  obks05 = 'obks01'
    obks06 = ''  obks07 = ''  obks08 = ''  obks09 = ''  obks10 = ''
    okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = ''
    okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = ''
    bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
    obkrcd = ''  okkrcd = ''  kkrhkb = ''
    bskart = '0.000'
    zdelflg = '' )

    ( client = '310'
    bstpkb = 'A1'
    frmndt = '201401'
    bsjkkb = '30'
    bstpsq = '0003'
    bstpnm = '旭　本番用　2018年3月から'
    tomndt = '000000'
    rtchkb = 'A'  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
    bsjnkb = '40'  bsjnnm = '配送料DP1：◇構造資材◇'  bsksfg = ''
    obks01 = '55113'  obks02 = '55113'  obks03 = '55113'  obks04 = '55113'  obks05 = '55113'
    obks06 = '55113'  obks07 = '55113'  obks08 = '55113'  obks09 = '55113'  obks10 = '55113'
    okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = ''
    okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = ''
    bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
    obkrcd = ''  okkrcd = ''  kkrhkb = ''
    bskart = '0.000'
    zdelflg = '' )

    ( client = '310'
    bstpkb = 'A1'
    frmndt = '201401'
    bsjkkb = '40'
    bstpsq = '0000'
    bstpnm = '旭　本番用　2018年3月から'
    tomndt = '000000'
    bsspkb = '21'
    rtchkb = 'A'  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
    bsjnkb = '10'  bsjnnm = '配送料DP1：◇構造資材◇'  bsksfg = ''
    obks01 = 'obks01'  obks02 = 'obks01'  obks03 = 'obks01'  obks04 = 'obks01'  obks05 = 'obks01'
    obks06 = ''  obks07 = ''  obks08 = ''  obks09 = ''  obks10 = ''
    okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = ''
    okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = ''
    bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
    obkrcd = ''  okkrcd = ''  kkrhkb = '08'
    bskart = '0.000'
    zdelflg = '' )

    ( client = '310'
    bstpkb = 'A1'
    frmndt = '201401'
    bsjkkb = ''
    bstpsq = '0000'
    bstpnm = '旭　本番用　2018年3月から'
    tomndt = '000000'
    bsspkb = '30'
    rtchkb = 'A'  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
    bsjnkb = '10'  bsjnnm = '配送料DP1：◇構造資材◇'  bsksfg = ''
    obks01 = 'obks01'  obks02 = 'obks01'  obks03 = 'obks01'  obks04 = 'obks01'  obks05 = 'obks01'
    obks06 = ''  obks07 = ''  obks08 = ''  obks09 = ''  obks10 = ''
    okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = ''
    okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = ''
    bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
    obkrcd = ''  okkrcd = ''  kkrhkb = '08'
    bskart = ''
    zdelflg = '' )
    ).

    object_main->glb_db_0202 = VALUE #(

    (
     bkenct = 'B25X023563'
     judnno = 'A252063997'
     jugysq = '1'
     ykjono = ''
     hbsocd = 'A000'
     rtchcd = '00'
     shnbcd = '00'
     sitncd = 'A25'
     egbucd = 'A252'
     obsycd = '55113'
     obsynm = '埼玉A'
     jdbrno = 'A2'
     skpocd = ''
     bkenno = ''
     hnsycd = ''
     gbbpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸﾞ'
     gadrcd = '11101'
     gadscd = '11'
     gabpnm = ''
     nobpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸ'
     noadcd = ''
     nabpnm = ''
     notlno = ''
     kuixkb = ''
     gtytcd = ''
     gtytnm = ''
     tkykcd = '1172'
     tkkjnm = '所沢資材'
     sktncd = 'ZZZZ'
     skkjnm = '　'
     gtkstx = ''
     mubpnm = '配送料DP1：◇構造資材◇'
     jbkotx = ''
     hinmcd = '9999Z10028'
     sehnnm = '配送料DP1：◇構造資材◇'
     syuksr = '1'
     bpjysr = '0'
     ksunst = '0'
     bpsktn = '0.00'
     bpskkg = '0.00'
     juchdt = '20140320'
     bpnodt = '20140315'
     hdbucd = 'DP1'
     hcbucd = 'DP19999'
     hsbucd = 'DP199999999'
     kabtkb = '08'
     bnrikb = '90'
     senucd = ''
     senunm = ''
     kyakcd = ''
     kyaknm = ''
     icmpnm = ''
     iadrcd = ''
     iabpnm = ''
     itelno = ''
     kkbpnm = ''
     kzadcd = ''
     kzadnm = ''
     kztlno = ''
     sysxdt = '20140321'
     syordt = '20140101'
     okykcd = '01110103'
     okyknm = '旭　東京'
     bpurtn = '1500.00'
     bpurkg = '1500.00'
     juchcd = '107480103B'
     msercd = ''
     bpjtdt = '20140321'
     gtksdt = '20140331'
     routkb = 'A'
     kbtjdt = '0'
     zdelflg = ''
     zaedat = '20251014'
     created_by = ''
     created_at = '0.0000000'
     last_changed_by = ''
     local_last_changed_at = '0.0000000'
     last_changed_at = '0.0000000'
     ) ).

    object_main->glb_db_tvkbt = VALUE #(
    ( vkbur = 'A252'
    spras = 'J'
    bezei = '東部営業二部' )
     ).

    object_main->glb_it_kabtkb = VALUE #(
    ( kabtkb = '02' kabtnm = 'Ⅰ型V' )
    ( kabtkb = '03' kabtnm = 'Ⅱ型' )
    ( kabtkb = '04' kabtnm = '円型' )
    ( kabtkb = '05' kabtnm = 'NT' )
    ( kabtkb = '06' kabtnm = 'P3' )
    ( kabtkb = '07' kabtnm = 'Hz' )
    ( kabtkb = '08' kabtnm = 'OSリング' )
    ).

    object_main->glb_db_makt = VALUE #(
    ( spras = 'J'
    maktx = '配送料DP1：◇構造資材◇'
    maktg = '配送料DP1：◇構造資材◇'
    matnr = '9999Z10028' )

    ( spras = 'J'
    maktx = 'ＢＰ　２０－０９Ｖ　Ｈ－３８００'
    maktg = 'ＢＰ　２０－０９Ｖ　Ｈ－３８００'
    matnr = '1484020065' )

    ( spras = 'J'
    maktx = 'ＢＰ　２０－０９Ｖ　Ｈ－３８００'
    maktg = 'ＢＰ　２０－０９Ｖ　Ｈ－３８００'
    matnr = '9999Z10029' )
    ).


    " Insert test data for zsdt0210
    item_0210 = VALUE #(
     ( obsycd = '55113'
      okykcd = '01110103'
      syokcd = 'B'
     )
     ( obsycd = '55111'
      okykcd = '01110104'
      syokcd = 'A'
     )
     ( obsycd = '55131'
      okykcd = '01110104'
      syokcd = 'C'
     )
     ( obsycd = '55131'
      okykcd = '01110103'
      syokcd = 'E'
     )
     ( obsycd = '55114'
      okykcd = '01110103'
      syokcd = 'A'
     )
     ).

    " Insert test data for zsdt0202
    item_0202 = VALUE #(
     (
     bkenct = 'B25X023563'
     judnno = 'A252063997'
     jugysq = '2'
     ykjono = ''
     hbsocd = 'A000'
     rtchcd = '00'
     shnbcd = '00'
     sitncd = 'A25'
     egbucd = 'A252'
     obsycd = '55113'
     obsynm = '埼玉A'
     jdbrno = 'A2'
     skpocd = ''
     bkenno = ''
     hnsycd = ''
     gbbpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸﾞ'
     gadrcd = '11101'
     gadscd = '11'
     gabpnm = ''
     nobpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸ'
     noadcd = ''
     nabpnm = ''
     notlno = ''
     kuixkb = ''
     gtytcd = ''
     gtytnm = ''
     tkykcd = 'R200'
     tkkjnm = '所沢資材'
     sktncd = 'ZZZZ'
     skkjnm = '　'
     gtkstx = ''
     mubpnm = '配送料DP1：◇構造資材◇'
     jbkotx = ''
     hinmcd = '9999Z10028'
     sehnnm = '配送料DP1：◇構造資材◇'
     syuksr = '1'
     bpjysr = '0'
     ksunst = '0'
     bpsktn = '0.00'
     bpskkg = '0.00'
     juchdt = '20140320'
     bpnodt = '20140315'
     hdbucd = 'DP1'
     hcbucd = 'DP19999'
     hsbucd = 'DP199999999'
     kabtkb = '08'
     bnrikb = '90'
     senucd = ''
     senunm = ''
     kyakcd = ''
     kyaknm = ''
     icmpnm = ''
     iadrcd = ''
     iabpnm = ''
     itelno = ''
     kkbpnm = ''
     kzadcd = ''
     kzadnm = ''
     kztlno = ''
     sysxdt = '20080101'
     syordt = '20080101'
     okykcd = '01110103'
     okyknm = '旭　東京'
     bpurtn = '1500.00'
     bpurkg = '1500.00'
     juchcd = '107480103B'
     msercd = ''
     bpjtdt = '20140321'
     gtksdt = '20140331'
     routkb = 'A'
     kbtjdt = '0'
     zdelflg = ''
     zaedat = '20251014'
     created_by = ''
     created_at = '0.0000000'
     last_changed_by = ''
     local_last_changed_at = '0.0000000'
     last_changed_at = '0.0000000'
     )
    (
     bkenct = 'B25X023563'
     judnno = 'A252063997'
     jugysq = '1'
     hbsocd = 'A000'
     rtchcd = '00'
     shnbcd = '00'
     sitncd = 'A25'
     egbucd = 'A252'
     obsycd = '55113'
     obsynm = '埼玉A'
     jdbrno = 'A2'
     gbbpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸﾞ'
     gadrcd = '11101'
     gadscd = '11'
     nobpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸ'
     tkykcd = 'R200'
     tkkjnm = '所沢資材'
     sktncd = 'ZZZZ'
     mubpnm = '配送料DP1：◇構造資材◇'
     hinmcd = '9999Z10028'
     sehnnm = '配送料DP1：◇構造資材◇'
     syuksr = '1'
     bpjysr = '0'
     ksunst = '0'
     bpsktn = '0.00'
     bpskkg = '0.00'
     juchdt = '20140320'
     bpnodt = '20140315'
     hdbucd = 'DP1'
     hcbucd = 'DP19999'
     hsbucd = 'DP199999999'
     kabtkb = '08'
     bnrikb = '90'
     sysxdt = '20140321'
     syordt = '20140101'
     okykcd = '01110103'
     okyknm = '旭　東京'
     bpurtn = '1500.00'
     bpurkg = '1200.00'
     juchcd = '107480103B'
     bpjtdt = '20140321'
     gtksdt = '20140331'
     routkb = 'A'
     zdelflg = ''
     )

    ).
    item_0224 = VALUE #(
    ( bstpkb = 'A1' bstpnm = '旭　本番用　2014年1月から' frmndt = '201401' tomndt = '000000' bstnkb = '30' bsmrkb = '20' bsmtkb = '10' bsshkb = '10' )
*    ( bstpkb = 'A1' bstpnm = '旭　本番用　2014年1月から' frmndt = '201401' tomndt = '000001' bstnkb = '30' bsmrkb = '20' bsmtkb = '10' bsshkb = '20' )
*    ( bstpkb = 'A1' bstpnm = '旭　本番用　2014年1月から' frmndt = '201401' tomndt = '000002' bstnkb = '30' bsmrkb = '20' bsmtkb = '10' bsshkb = '30' )
*    ( bstpkb = 'A1' bstpnm = '旭　本番用　2014年1月から' frmndt = '201401' tomndt = '000003' bstnkb = '30' bsmrkb = '20' bsmtkb = '10' bsshkb = '40' )
*    ( bstpkb = 'A1' bstpnm = '旭　本番用　2014年1月から' frmndt = '201401' tomndt = '000004' bstnkb = '30' bsmrkb = '20' bsmtkb = '10' bsshkb = '40' )
     ).

    item_0225 = VALUE #(
    ( bstpkb = 'A1' bsjkkb = '' bstpnm = '旭　本番用　2014年1月から' frmndt = '201401' tomndt = '000001' bsspkb = '10' )
    ( bstpkb = 'A1' frmndt = '201401' bsjkkb = '50' bstpsq = '0001' bstpnm = '旭　本番用　2018年3月から' tomndt = '000002' bsspkb = '20' )
    ( bstpkb = 'A1' frmndt = '201401' bsjkkb = '50' bstpsq = '0002' bstpnm = '旭　本番用　2018年3月から' tomndt = '000003' bsspkb = '21' )
    ( bstpkb = 'A1' frmndt = '201401' bsjkkb = '50' bstpsq = '0003' bstpnm = '旭　本番用　2018年3月から' tomndt = '000004' bsspkb = '30' )
    ( bstpkb = 'A1' frmndt = '201401' bsjkkb = '10' bstpsq = '0000' bstpnm = '旭　本番用　2018年3月から' tomndt = '000000' rtchkb = 'A'  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
    bsjnkb = '10'  bsjnnm = '配送料DP1：◇構造資材◇'  bsksfg = '' obks01 = 'obks01'  obks02 = 'obks01'  obks03 = 'obks01'  obks04 = 'obks01'  obks05 = 'obks01' obks06 = ''  obks07 = ''  obks08 = ''  obks09 = ''  obks10 = ''
    okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = '' okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = '' bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
    obkrcd = ''  okkrcd = ''  kkrhkb = ''
    bskart = '0.000'
    zdelflg = '' )
    ( client = '310'
    bstpkb = 'A1'
    frmndt = '201401'
    bsjkkb = '20'
    bstpsq = '0010'
    bstpnm = '旭　本番用　2018年3月から'
    tomndt = '000000'
    bsspkb = '21'
    rtchkb = 'A'  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
    bsjnkb = '10'  bsjnnm = '配送料DP2：◇構造資材◇'  bsksfg = ''
    obks01 = '55113'  obks02 = 'obks01'  obks03 = 'obks01'  obks04 = 'obks01'  obks05 = 'obks01'
    obks06 = ''  obks07 = ''  obks08 = ''  obks09 = ''  obks10 = ''
    okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = ''
    okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = ''
    bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
    obkrcd = ''  okkrcd = ''  kkrhkb = '08'
    bskart = '0.000'
    zdelflg = '' )

    ( client = '310'
    bstpkb = 'A1'
    frmndt = '201401'
    bsjkkb = ''
    bstpsq = '0002'
    bstpnm = '旭　本番用　2018年3月から'
    tomndt = '000000'
    bsspkb = '30'
    rtchkb = 'A'  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
    bsjnkb = '10'  bsjnnm = '配送料DP1：◇構造資材◇'  bsksfg = ''
    obks01 = 'obks01'  obks02 = 'obks01'  obks03 = 'obks01'  obks04 = 'obks01'  obks05 = 'obks01'
    obks06 = ''  obks07 = ''  obks08 = ''  obks09 = ''  obks10 = ''
    okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = ''
    okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = ''
    bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
    obkrcd = ''  okkrcd = ''  kkrhkb = '08'
    bskart = ''
    zdelflg = '' )

    ).

    item_0284 = VALUE #(
    ( tkykcd = 'R200' tkkjnm = '（株）東谷' syrbkb = 'P' syrbnm = '中国' )
     ).
    item_tvkbt = VALUE #(
   ( vkbur = 'A252'
   spras = 'J'
   bezei = '東部営業二部' )
    ).
    sql_test_environment->insert_test_data( i_data = item_0202 ).
    sql_test_environment->insert_test_data( i_data = item_0210 ).
    sql_test_environment->insert_test_data( i_data = item_0224 ).
    sql_test_environment->insert_test_data( i_data = item_0225 ).
    sql_test_environment->insert_test_data( i_data = item_0284 ).
    sql_test_environment->insert_test_data( i_data = item_tvkbt ).


  ENDMETHOD.


  METHOD prepare_testdata_empty.
    sql_test_environment->clear_doubles( ).
    CREATE OBJECT object_main FOR TESTING.

    DATA:
      item_0202 TYPE STANDARD TABLE OF zsdt0202 WITH EMPTY KEY,
      item_0224 TYPE STANDARD TABLE OF zsdt0224 WITH EMPTY KEY,
      item_0210 TYPE STANDARD TABLE OF zsdt0210 WITH EMPTY KEY.

    " Insert test data
    item_0210 = VALUE #( ).
    item_0202 = VALUE #( ).
    item_0224 = VALUE #( ).

    sql_test_environment->insert_test_data( i_data = item_0202 ).
    sql_test_environment->insert_test_data( i_data = item_0224 ).
    sql_test_environment->insert_test_data( i_data = item_0210 ).

  ENDMETHOD.

  METHOD prepare_testdata_item0224empty.
    sql_test_environment->clear_doubles( ).
    CREATE OBJECT object_main FOR TESTING.

    DATA:
      item_0202 TYPE STANDARD TABLE OF zsdt0202 WITH EMPTY KEY,
      item_0224 TYPE STANDARD TABLE OF zsdt0224 WITH EMPTY KEY.

    item_0202 = VALUE #(
  (
  bkenct = 'B25X023563'
  judnno = 'A252063997'
  jugysq = '2'
  ykjono = ''
  hbsocd = 'A000'
  rtchcd = '00'
  shnbcd = '00'
  sitncd = 'A25'
  egbucd = 'A252'
  obsycd = '55113'
  obsynm = '埼玉A'
  jdbrno = 'A2'
  skpocd = ''
  bkenno = ''
  hnsycd = ''
  gbbpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸﾞ'
  gadrcd = '11101'
  gadscd = '11'
  gabpnm = ''
  nobpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸ'
  noadcd = ''
  nabpnm = ''
  notlno = ''
  kuixkb = ''
  gtytcd = ''
  gtytnm = ''
  tkykcd = '1172'
  tkkjnm = '所沢資材'
  sktncd = 'ZZZZ'
  skkjnm = '　'
  gtkstx = ''
  mubpnm = '配送料DP1：◇構造資材◇'
  jbkotx = ''
  hinmcd = '9999Z10028'
  sehnnm = '配送料DP1：◇構造資材◇'
  syuksr = '1'
  bpjysr = '0'
  ksunst = '0'
  bpsktn = '0.00'
  bpskkg = '0.00'
  juchdt = '20080101'
  bpnodt = '20080101'
  hdbucd = 'DP1'
  hcbucd = 'DP19999'
  hsbucd = 'DP199999999'
  kabtkb = '08'
  bnrikb = '90'
  senucd = ''
  senunm = ''
  kyakcd = ''
  kyaknm = ''
  icmpnm = ''
  iadrcd = ''
  iabpnm = ''
  itelno = ''
  kkbpnm = ''
  kzadcd = ''
  kzadnm = ''
  kztlno = ''
  sysxdt = '20080101'
  syordt = '20080101'
  okykcd = '01110103'
  okyknm = '旭　東京'
  bpurtn = '1500.00'
  bpurkg = '1500.00'
  juchcd = '107480103B'
  msercd = ''
  bpjtdt = '20140321'
  gtksdt = '20140331'
  routkb = 'A'
  kbtjdt = '0'
  zdelflg = ''
  zaedat = '20251014'
  created_by = ''
  created_at = '0.0000000'
  last_changed_by = ''
  local_last_changed_at = '0.0000000'
  last_changed_at = '0.0000000'
  )
 ).
    item_0224 = VALUE #(
    ( bstpkb = 'A1' bstpnm = '旭　本番用　2014年1月から' frmndt = '201401' tomndt = '000000' bstnkb = '30' bsmrkb = '20' bsmtkb = '10' bsshkb = '10' )
     ).
    " Insert test data


    sql_test_environment->insert_test_data( i_data = item_0202 ).
    sql_test_environment->insert_test_data( i_data = item_0224 ).
  ENDMETHOD.

  METHOD teardown.
    IF sql_test_environment IS BOUND.
      sql_test_environment->clear_doubles( ).
    ENDIF.
  ENDMETHOD.

  METHOD testcase_01_1.
    DATA: item_0202 TYPE STANDARD TABLE OF zsdt0202,
          act_res   TYPE i.
    prepare_testdata_set(  ).

    object_main->glb_it_kabtkb = VALUE #( ( kabtkb = '02' kabtnm = 'Ⅰ型V' ) ).

    object_main->procd(
     EXPORTING
       i_bsshkb    = '10'        " 奨励金集約区分
       i_bstpkb    = 'A1'        " 奨励金タイプ
   ).
    SELECT bkenct
    FROM zsdt0202
    WHERE syordt >= '20140101' AND syordt < '20150101' AND bpurkg <> 0 AND zdelflg <> 'X'
    INTO TABLE @item_0202.

    DATA(lv_expected) = lines( item_0202 ).

    LOOP AT object_main->glb_db_0202 INTO DATA(item)
      WHERE syordt >= '20140101' AND syordt < '20150101' AND bpurkg <> 0 AND zdelflg <> 'X'.
      act_res = act_res + 1.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
      exp = 1
      act = act_res
      msg = 'Only records within date range should be processed'
      quit = if_aunit_constants=>quit-test
    ).
  ENDMETHOD.

  METHOD testcase_01_2.
    prepare_testdata_empty( ).
    DATA: act_res   TYPE i.

    object_main->procd(
     EXPORTING
       i_bsshkb    = '10'        " 奨励金集約区分
       i_bstpkb    = 'A1'        " 奨励金タイプ
   ).

    LOOP AT object_main->glb_db_0202 INTO DATA(item)
      WHERE syordt >= '20140101' AND syordt < '20150101' AND bpurkg <> 0 AND zdelflg <> 'X'.
      act_res = act_res + 1.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
      EXPORTING
        act  = act_res
        exp  = 0
        msg  = 'procd handles empty 0202 data correctly'
        quit = if_aunit_constants=>quit-test
    ).


  ENDMETHOD.

  METHOD testcase_01_3.
    DATA: item_0224 TYPE STANDARD TABLE OF zsdt0224,
          act_res   TYPE i.
    prepare_testdata_set(  ).

    object_main->glb_it_kabtkb = VALUE #( ( kabtkb = '02' kabtnm = 'Ⅰ型V' ) ).

    object_main->procd(
     EXPORTING
       i_bsshkb    = '10'        " 奨励金集約区分
       i_bstpkb    = 'A1'        " 奨励金タイプ
   ).
    SELECT bstpkb
    FROM zsdt0224
    WHERE frmndt <= '202401' AND zdelflg <> 'X'
    INTO TABLE @item_0224.

    DATA(lv_expected) = lines( item_0224 ).

    LOOP AT object_main->glb_db_0224 INTO DATA(item)
      WHERE frmndt <= '202401'.
      act_res = act_res + 1.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
      exp = 1
      act = act_res
      msg = 'Only records within date range should be processed'
      quit = if_aunit_constants=>quit-test
      ).
  ENDMETHOD.

  METHOD testcase_01_4.

    prepare_testdata_item0224empty(  ).
    DATA: item_0224 TYPE STANDARD TABLE OF zsdt0224,
          act_res   TYPE i,
          startdate TYPE dats,
          enddate   TYPE dats.

    startdate = '20080101'.
    enddate = '20081201'.
    object_main->glb_startdt = startdate.
    object_main->glb_enddt = enddate.


    object_main->glb_it_kabtkb = VALUE #( ( kabtkb = '02' kabtnm = 'Ⅰ型V' ) ).

    object_main->procd(
     EXPORTING
       i_bsshkb    = '10'        " 奨励金集約区分
       i_bstpkb    = 'A1'        " 奨励金タイプ
   ).
    SELECT bstpkb
    FROM zsdt0224
    WHERE bstpkb = 'A1' AND bsshkb = '10' AND zdelflg <> 'X'
    INTO TABLE @item_0224.

    DATA(lv_expected) = lines( item_0224 ).

    LOOP AT object_main->glb_db_0224 INTO DATA(item)
      WHERE frmndt <= '200801'.
      act_res = act_res + 1.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
      exp = 0
      act = act_res
      msg = 'procd handles empty 0224 data correctly'
      quit = if_aunit_constants=>quit-test
      ).
  ENDMETHOD.

  METHOD testcase_01_5.
    DATA: lt_0202      TYPE STANDARD TABLE OF zsdt0202,
          lt_tvkbt     TYPE STANDARD TABLE OF tvkbt,
          act_wxbsgec2 TYPE char5,
          act_wxbsgen2 TYPE char32,
          act_wxegbuc2 TYPE char4,
          act_wxegbun2 TYPE tvkbt-bezei,
          exp_wxbsgec2 TYPE char5,
          exp_wxbsgen2 TYPE char32,
          exp_wxegbuc2 TYPE char4,
          exp_wxegbun2 TYPE tvkbt-bezei.
    prepare_testdata_set(  ).
    " glb_in_bsshkb = 50
    object_main->chkprm(
     EXPORTING
       i_bsshkb    = '10'        " 奨励金集約区分
       i_frmndt    = '201401'    " 適用月度FROM
   ).
    object_main->procd(
     EXPORTING
       i_bsshkb    = '10'        " 奨励金集約区分
       i_bstpkb    = 'A1'        " 奨励金タイプ
   ).
    READ TABLE object_main->glb_it_okb6100 INTO DATA(item) WITH KEY gtksym = '201401'  kabtkb = '08'  kisokb = '10'.
    IF sy-subrc = 0.
      act_wxbsgec2 = item-bsgecd.
      act_wxbsgen2 = item-bsgenm.
      act_wxegbuc2 = item-egbucd.
      act_wxegbun2 = item-egbunm.
    ELSE.
      cl_abap_unit_assert=>assert_subrc(
      act = sy-subrc
      msg = 'Data missing in glb_db_0202'
      quit = if_aunit_constants=>quit-test ).
    ENDIF.

    SELECT obsycd, obsynm, kabtkb, egbucd
    FROM zsdt0202
    WHERE syordt >= '20140101' AND syordt < '20150101' AND bpurkg <> 0 AND zdelflg <> 'X'
    INTO CORRESPONDING FIELDS OF TABLE @lt_0202.

    READ TABLE lt_0202 INTO DATA(fs_0202) WITH KEY kabtkb = '08'.
    IF sy-subrc = 0.
      exp_wxbsgec2 = fs_0202-obsycd.
      exp_wxbsgen2 = fs_0202-obsynm.
    ENDIF.

    SELECT vkbur, bezei
    FROM tvkbt
    WHERE spras = 'J' AND vkbur = @fs_0202-egbucd
    INTO CORRESPONDING FIELDS OF TABLE @lt_tvkbt.
    READ TABLE lt_tvkbt
       INTO DATA(item_tvkbt)
       WITH KEY vkbur = fs_0202-egbucd.
    IF sy-subrc = 0.
      exp_wxegbuc2 = fs_0202-egbucd.
      exp_wxegbun2 = item_tvkbt-bezei.
    ENDIF.

    cl_abap_unit_assert=>assert_equals(
      act = act_wxbsgec2
      exp = exp_wxbsgec2
      msg = 'Confirm value for 旧部署コード'
      quit = if_aunit_constants=>quit-test
      ).
    cl_abap_unit_assert=>assert_equals(
    act = act_wxbsgen2
    exp = exp_wxbsgen2
    msg = 'Confirm value for 旧部署名'
    quit = if_aunit_constants=>quit-test
    ).
    cl_abap_unit_assert=>assert_equals(
    act = act_wxegbuc2
    exp = exp_wxegbuc2
    msg = 'Confirm value for 営業部'
    quit = if_aunit_constants=>quit-test
    ).
    cl_abap_unit_assert=>assert_equals(
   act = act_wxegbun2
   exp = exp_wxegbun2
   msg = 'Confirm value for 営業部名称'
   quit = if_aunit_constants=>quit-test
   ).
  ENDMETHOD.
  METHOD testcase_01_6.
    prepare_testdata_set(  ).
    DATA: lt_0202      TYPE STANDARD TABLE OF zsdt0202,
          item_0224    TYPE STANDARD TABLE OF zsdt0224,
          lt_tvkbt     TYPE STANDARD TABLE OF tvkbt,
          act_wxbsgec2 TYPE char5,
          act_wxbsgen2 TYPE char32,
          act_wxegbuc2 TYPE char4,
          act_wxegbun2 TYPE tvkbt-bezei,
          exp_wxbsgec2 TYPE char5,
          exp_wxbsgen2 TYPE char32,
          exp_wxegbuc2 TYPE char4,
          exp_wxegbun2 TYPE tvkbt-bezei.
    CLEAR: object_main->glb_in_bsshkb, object_main->glb_db_0224.

    TEST-INJECTION glb_in_bsshkb_51.
      glb_db_0224 = VALUE #(
        ( bstpkb = 'A1' bstpnm = '旭　本番用　2014年1月から' frmndt = '201401' tomndt = '000001' bstnkb = '30' bsmrkb = '20' bsmtkb = '10' bsshkb = '20' )
        ).
    END-TEST-INJECTION.
    " glb_in_bsshkb = 51
    object_main->chkprm(
     EXPORTING
       i_bsshkb    = '20'        " 奨励金集約区分
       i_frmndt    = '201401'    " 適用月度FROM
   ).
    object_main->procd(
     EXPORTING
       i_bsshkb    = '20'        " 奨励金集約区分
       i_bstpkb    = 'A1'        " 奨励金タイプ
   ).
    READ TABLE object_main->glb_it_okb6100 INTO DATA(item) WITH KEY gtksym = '201401' kabtkb = '08' kisokb = '10'.
    IF sy-subrc = 0.
      act_wxbsgec2 = item-bsgecd.
      act_wxbsgen2 = item-bsgenm.
      act_wxegbuc2 = item-egbucd.
      act_wxegbun2 = item-egbunm.
    ELSE.
      cl_abap_unit_assert=>assert_subrc(
      act = sy-subrc
      msg = 'Data missing in glb_db_0202'
      quit = if_aunit_constants=>quit-test ).
    ENDIF.

    SELECT okykcd, okyknm, egbucd, kabtkb
    FROM zsdt0202
    WHERE syordt >= '20140101' AND syordt < '20150101' AND bpurkg <> 0 AND zdelflg <> 'X'
    INTO CORRESPONDING FIELDS OF TABLE @lt_0202.
    READ TABLE lt_0202 INTO DATA(fs_0202) WITH KEY kabtkb = '08'.
    IF sy-subrc = 0.
      exp_wxbsgec2 = fs_0202-okykcd.
      exp_wxbsgen2 = fs_0202-okyknm.
    ENDIF.
    SELECT vkbur, bezei
    FROM tvkbt
    WHERE spras = 'J' AND vkbur = @fs_0202-egbucd
    INTO CORRESPONDING FIELDS OF TABLE @lt_tvkbt.
    READ TABLE lt_tvkbt
       INTO DATA(item_tvkbt)
       WITH KEY vkbur = fs_0202-egbucd.
    IF sy-subrc = 0.
      exp_wxegbuc2 = fs_0202-egbucd.
      exp_wxegbun2 = item_tvkbt-bezei.
    ENDIF.
    CLEAR: object_main->glb_db_0224.
    cl_abap_unit_assert=>assert_equals(
      act = act_wxbsgec2
      exp = exp_wxbsgec2
      msg = 'Confirm value for 旧客先コード'
      quit = if_aunit_constants=>quit-test
      ).
    cl_abap_unit_assert=>assert_equals(
    act = act_wxbsgen2
    exp = exp_wxbsgen2
    msg = 'Confirm value for 旧客先名'
    quit = if_aunit_constants=>quit-test
    ).
    cl_abap_unit_assert=>assert_equals(
    act = act_wxegbuc2
    exp = exp_wxegbuc2
    msg = 'Confirm value for 営業部'
    quit = if_aunit_constants=>quit-test
    ).
    cl_abap_unit_assert=>assert_equals(
   act = act_wxegbun2
   exp = exp_wxegbun2
   msg = 'Confirm value for 営業部名称'
   quit = if_aunit_constants=>quit-test
   ).
  ENDMETHOD.

  METHOD testcase_01_7.
    prepare_testdata_set(  ).
    DATA: lt_0202      TYPE STANDARD TABLE OF zsdt0202,
          lt_0284      TYPE STANDARD TABLE OF zsdt0284,
          act_wxbsgec2 TYPE char5,
          act_wxbsgen2 TYPE char32,
          act_wxegbuc2 TYPE char4,
          act_wxegbun2 TYPE tvkbt-bezei,
          exp_wxbsgec2 TYPE char5,
          exp_wxbsgen2 TYPE char32,
          exp_wxegbuc2 TYPE char4,
          exp_wxegbun2 TYPE tvkbt-bezei.
    CLEAR: object_main->glb_in_bsshkb, object_main->glb_db_0224.

    TEST-INJECTION glb_in_bsshkb_52.
      glb_db_0224 = VALUE #(
        ( bstpkb = 'A1' bstpnm = '旭　本番用　2014年1月から' frmndt = '201401' tomndt = '000001' bstnkb = '30' bsmrkb = '30' bsmtkb = '10' bsshkb = '30' )
        ).
    END-TEST-INJECTION.
    " glb_in_bsshkb = 52
    object_main->chkprm(
     EXPORTING
       i_bsshkb    = '30'        " 奨励金集約区分
       i_frmndt    = '201401'    " 適用月度FROM
   ).
    object_main->procd(
     EXPORTING
       i_bsshkb    = '30'        " 奨励金集約区分
       i_bstpkb    = 'A1'        " 奨励金タイプ
   ).
    READ TABLE object_main->glb_it_okb6100 INTO DATA(item) WITH KEY gtksym = '201401' kabtkb = '08' kisokb = '10'.
    IF sy-subrc = 0.
      act_wxbsgec2 = item-bsgecd.
      act_wxbsgen2 = item-bsgenm.
      act_wxegbuc2 = item-egbucd.
      act_wxegbun2 = item-egbunm.
    ELSE.
      cl_abap_unit_assert=>assert_subrc(
      act = sy-subrc
      msg = 'Data missing in glb_db_0202'
      quit = if_aunit_constants=>quit-test ).
    ENDIF.
    SELECT okykcd, okyknm, kabtkb, tkykcd, tkkjnm
    FROM zsdt0202
    WHERE syordt >= '20140101' AND syordt < '20150101' AND bpurkg <> 0 AND zdelflg <> 'X'
    INTO CORRESPONDING FIELDS OF TABLE @lt_0202.
    READ TABLE lt_0202 INTO DATA(fs_0202) WITH KEY kabtkb = '08'.
    IF sy-subrc = 0.
      exp_wxbsgec2 = fs_0202-tkykcd.
      exp_wxbsgen2 = fs_0202-tkkjnm.
    ENDIF.
    SELECT syrbkb, syrbnm, tkykcd
    FROM zsdt0284
    WHERE tkykcd = @exp_wxbsgec2
    INTO CORRESPONDING FIELDS OF TABLE @lt_0284.
    READ TABLE lt_0284
       INTO DATA(item_0284)
       WITH KEY tkykcd = fs_0202-tkykcd.
    IF sy-subrc = 0.
      exp_wxegbuc2 = item_0284-syrbkb.
      exp_wxegbun2 = item_0284-syrbnm.
    ENDIF.
    CLEAR: object_main->glb_db_0224.
    cl_abap_unit_assert=>assert_equals(
      act = act_wxbsgec2
      exp = exp_wxbsgec2
      msg = 'Confirm value for 特施工コード'
      quit = if_aunit_constants=>quit-test
      ).
    cl_abap_unit_assert=>assert_equals(
    act = act_wxbsgen2
    exp = exp_wxbsgen2
    msg = 'Confirm value for 特施工店名称'
    quit = if_aunit_constants=>quit-test
    ).
    cl_abap_unit_assert=>assert_equals(
    act = act_wxegbuc2
    exp = exp_wxegbuc2
    msg = 'Confirm value for 営業部'
    quit = if_aunit_constants=>quit-test
    ).
    cl_abap_unit_assert=>assert_equals(
   act = act_wxegbun2
   exp = exp_wxegbun2
   msg = 'Confirm value for 営業部名称'
   quit = if_aunit_constants=>quit-test
   ).
  ENDMETHOD.

  METHOD testcase_01_8.
    prepare_testdata_set(  ).
    DATA: lt_0202      TYPE STANDARD TABLE OF zsdt0202,
          lt_0206      TYPE STANDARD TABLE OF zsdt0206,
          act_wxbsgec2 TYPE char5,
          act_wxbsgen2 TYPE char32,
          act_wxegbuc2 TYPE char4,
          act_wxegbun2 TYPE tvkbt-bezei,
          exp_wxbsgec2 TYPE char5,
          exp_wxbsgen2 TYPE char32,
          exp_wxegbuc2 TYPE char4,
          exp_wxegbun2 TYPE tvkbt-bezei.
    CLEAR: object_main->glb_in_bsshkb, object_main->glb_db_0224.

    TEST-INJECTION glb_in_bsshkb_53.
      glb_db_0224 = VALUE #(
        ( bstpkb = 'A1' bstpnm = '旭　本番用　2014年1月から' frmndt = '201401' tomndt = '000001' bstnkb = '30' bsmrkb = '30' bsmtkb = '10' bsshkb = '40' )
        ).
    END-TEST-INJECTION.
    " glb_in_bsshkb = 53
    object_main->chkprm(
     EXPORTING
       i_bsshkb    = '40'        " 奨励金集約区分
       i_frmndt    = '201401'    " 適用月度FROM
   ).
    object_main->procd(
     EXPORTING
       i_bsshkb    = '40'        " 奨励金集約区分
       i_bstpkb    = 'A1'        " 奨励金タイプ
   ).
    READ TABLE object_main->glb_it_okb6100 INTO DATA(item) WITH KEY gtksym = '201401' kabtkb = '08' kisokb = '10'.
    IF sy-subrc = 0.
      act_wxbsgec2 = item-bsgecd.
      act_wxbsgen2 = item-bsgenm.
      act_wxegbuc2 = item-egbucd.
      act_wxegbun2 = item-egbunm.
    ELSE.
      cl_abap_unit_assert=>assert_subrc(
      act = sy-subrc
      msg = 'Data missing in glb_db_0202'
      quit = if_aunit_constants=>quit-test ).
    ENDIF.
    SELECT okykcd, okyknm, gadscd, kabtkb
    FROM zsdt0202
    WHERE syordt >= '20140101' AND syordt < '20150101' AND bpurkg <> 0 AND zdelflg <> 'X'
    INTO CORRESPONDING FIELDS OF TABLE @lt_0202.
    READ TABLE lt_0202 INTO DATA(fs_0202) WITH KEY kabtkb = '08'.
    IF sy-subrc = 0.
      exp_wxbsgec2 = fs_0202-gadscd.
      exp_wxbsgen2 = ''.
    ENDIF.
    SELECT fukncd, jusykn, znktcd, tikunm
    FROM zsdt0206
    WHERE fukncd = @fs_0202-gadscd AND zdelflg <> 'X'
   INTO CORRESPONDING FIELDS OF TABLE @lt_0206.
    READ TABLE lt_0206
    INTO DATA(item_0206)
    WITH KEY fukncd = fs_0202-gadscd.
    IF sy-subrc = 0.
      exp_wxbsgen2 = item_0206-jusykn.
      exp_wxegbuc2 = item_0206-znktcd.
      exp_wxegbun2 = item_0206-tikunm.
    ENDIF.
    CLEAR: object_main->glb_db_0224.
    cl_abap_unit_assert=>assert_equals(
      act = act_wxbsgec2
      exp = exp_wxbsgec2
      msg = 'Confirm value for 現場住所コード都道'
      quit = if_aunit_constants=>quit-test
      ).
    cl_abap_unit_assert=>assert_equals(
    act = act_wxbsgen2
    exp = exp_wxbsgen2
    msg = 'Confirm value for 住所名漢'
    quit = if_aunit_constants=>quit-test
    ).
    cl_abap_unit_assert=>assert_equals(
    act = act_wxegbuc2
    exp = exp_wxegbuc2
    msg = 'Confirm value for 営業部'
    quit = if_aunit_constants=>quit-test
    ).
    cl_abap_unit_assert=>assert_equals(
   act = act_wxegbun2
   exp = exp_wxegbun2
   msg = 'Confirm value for 営業部名称'
   quit = if_aunit_constants=>quit-test
   ).
  ENDMETHOD.

  METHOD testcase_01_9.
    prepare_testdata_set( ).
    CLEAR: object_main->glb_db_0225.

    DATA:
      item_0202 TYPE zsdt0202,
      item_0224 TYPE zsdt0224,
      item_0225 TYPE STANDARD TABLE OF zsdt0225,
      is_valid  TYPE abap_bool,
      exp_res   TYPE i,
      act_res   TYPE i.

    item_0202 = VALUE #(  ).
    item_0224 = VALUE #(  ).

    SELECT bstpkb
    FROM zsdt0225
    WHERE bstpkb = '10' AND frmndt = '201401' AND zdelflg <> 'X'
    INTO TABLE @item_0225.
    IF sy-subrc = 0.
      exp_res = lines( item_0225 ).
    ENDIF.

    object_main->chk1020(
     EXPORTING
       i_bsjkkb    = '10'        " 奨励金条件区分
       item_0202   = item_0202
       item_0224   = item_0224
     IMPORTING
     is_valid   = is_valid
   ).
    LOOP AT object_main->glb_db_0225 INTO DATA(item) WHERE bsjkkb = '10' AND frmndt = '201401'.
      act_res += 1.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
      EXPORTING
        act  = act_res
        exp  = exp_res
        msg  = 'Only records within date range should be processed'
        quit = if_aunit_constants=>quit-test
    ).

  ENDMETHOD.

  METHOD testcase_01_10.
    prepare_testdata_item0225( ).
    CLEAR: object_main->glb_db_0225.
    DATA:
      item_0202 TYPE zsdt0202,
      item_0224 TYPE zsdt0224,
      is_valid  TYPE abap_bool,
      act_res   TYPE i.

    item_0202 = VALUE #(  ).
    item_0224 = VALUE #(  ).

    object_main->chk1020(
     EXPORTING
       i_bsjkkb    = '10'        " 奨励金条件区分
       item_0202   = item_0202
       item_0224   = item_0224
     IMPORTING
     is_valid   = is_valid
   ).
    LOOP AT object_main->glb_db_0225 INTO DATA(item) WHERE bsjkkb = '10' AND frmndt = '201401'.
      act_res += 1.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
      EXPORTING
        act  = act_res
        exp  = 0
        msg  = 'procd handles empty 0225 data correctly'
        quit = if_aunit_constants=>quit-test
    ).
  ENDMETHOD.

  METHOD testcase_01_11.
    prepare_testdata_set( ).
    DATA:
      item_0202 TYPE zsdt0202,
      item_0224 TYPE zsdt0224,
      act_res   TYPE abap_bool.

    item_0202 = VALUE #( routkb = '' ).
    item_0224 = VALUE #(  ).

    DATA(lv_expected) = abap_false.
    object_main->chk1020(
     EXPORTING
       i_bsjkkb    = '10'        " 奨励金条件区分
       item_0202   = item_0202
       item_0224   = item_0224
     IMPORTING
     is_valid   = act_res

   ).

    cl_abap_unit_assert=>assert_equals(
      EXPORTING
        act  = act_res
        exp  = lv_expected
        msg  = 'Routkb is empty'
        quit = if_aunit_constants=>quit-test
    ).

  ENDMETHOD.

  METHOD testcase_01_12.
    prepare_testdata_set( ).
    DATA:
      item_0202 TYPE zsdt0202,
      item_0224 TYPE zsdt0224,
      act_res   TYPE abap_bool.

    item_0202 = VALUE #( routkb = 'A' kabtkb = '' ).
    item_0224 = VALUE #(  ).

    DATA(lv_expected) = abap_false.
    object_main->chk1020(
     EXPORTING
       i_bsjkkb    = '10'        " 奨励金条件区分
       item_0202   = item_0202
       item_0224   = item_0224
     IMPORTING
     is_valid   = act_res

   ).

    cl_abap_unit_assert=>assert_equals(
      EXPORTING
        act  = act_res
        exp  = lv_expected
        msg  = 'Kabtkb is empty'
        quit = if_aunit_constants=>quit-test
    ).

  ENDMETHOD.

  METHOD testcase_01_13.
    prepare_testdata_set( ).
    DATA:
      item_0202 TYPE zsdt0202,
      item_0224 TYPE zsdt0224,
      act_res   TYPE abap_bool.

    item_0202 = VALUE #( routkb = 'A' kabtkb = '08' obsycd = '55114' ).
    item_0224 = VALUE #(  ).

    DATA(lv_expected) = abap_false.
    object_main->chk1020(
     EXPORTING
       i_bsjkkb    = '10'        " 奨励金条件区分
       item_0202   = item_0202
       item_0224   = item_0224
     IMPORTING
     is_valid   = act_res

   ).

    cl_abap_unit_assert=>assert_equals(
      EXPORTING
        act  = act_res
        exp  = lv_expected
        msg  = 'Obsycd is empty'
        quit = if_aunit_constants=>quit-test
    ).

  ENDMETHOD.

  METHOD testcase_01_14.
    prepare_testdata_set( ).
    DATA:
      item_0202 TYPE zsdt0202,
      item_0224 TYPE zsdt0224,
      act_res   TYPE abap_bool.

    item_0202 = VALUE #( routkb = 'A' kabtkb = '08' obsycd = '55113'  okykcd = '01110104' ).
    item_0224 = VALUE #(  ).

    DATA(lv_expected) = abap_false.
    object_main->chk1020(
     EXPORTING
       i_bsjkkb    = '10'        " 奨励金条件区分
       item_0202   = item_0202
       item_0224   = item_0224
     IMPORTING
     is_valid   = act_res

   ).

    cl_abap_unit_assert=>assert_equals(
      EXPORTING
        act  = act_res
        exp  = lv_expected
        msg  = 'Okykcd is empty'
        quit = if_aunit_constants=>quit-test
    ).

  ENDMETHOD.

  " 元請指定
  METHOD  testcase_01_15.
    prepare_testdata_set( ).
    DATA:
      item_0202 TYPE zsdt0202,
      item_0224 TYPE zsdt0224,
      act_res   TYPE abap_bool.


    object_main->glb_db_0225 = VALUE #( ( bsjkkb = '20' bsjnkb = '10' bsjnnm = 'test'
     bstpnm = '旭　本番用　2018年3月から'
    tomndt = '000000'
    rtchkb = 'A'  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
    bsksfg = ''
    obks01 = '55113'  obks02 = '55113'  obks03 = '55113'  obks04 = '55113'  obks05 = '55113'
    obks06 = '55113'  obks07 = '55113'  obks08 = '55113'  obks09 = '55113'  obks10 = '55113'
    okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = ''
    okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = ''
    bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
    obkrcd = ''  okkrcd = ''  kkrhkb = ''
    bskart = '0.000') ).

    item_0202 = VALUE #( routkb = 'A' kabtkb = '08' obsycd = '55113'  okykcd = '01110103' mubpnm = 'Test' ).
    item_0224 = VALUE #(  ).

    DATA(lv_expected) = abap_false.
    object_main->chk1020(
     EXPORTING
       i_bsjkkb    = '20'        " 奨励金条件区分
       item_0202   = item_0202
       item_0224   = item_0224
     IMPORTING
     is_valid   = act_res

   ).
    CLEAR: object_main->glb_db_0225.
    cl_abap_unit_assert=>assert_equals(
      EXPORTING
        act  = act_res
        exp  = lv_expected
        msg  = '元請指定 is empty'
        quit = if_aunit_constants=>quit-test
    ).

  ENDMETHOD.

  " ＳＡＰ品目コード
  METHOD testcase_01_16.
    prepare_testdata_set( ).
    DATA:
      item_0202 TYPE zsdt0202,
      item_0224 TYPE zsdt0224,
      act_res   TYPE abap_bool.

    object_main->glb_db_0225 = VALUE #( ( bsjkkb = '10' bsjnkb = '30' bsjnnm = 'test'
    bstpnm = '旭　本番用　2018年3月から'
   tomndt = '000000'
   rtchkb = 'A'  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
   bsksfg = ''
   obks01 = '55113'  obks02 = '55113'  obks03 = '55113'  obks04 = '55113'  obks05 = '55113'
   obks06 = '55113'  obks07 = '55113'  obks08 = '55113'  obks09 = '55113'  obks10 = '55113'
   okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = ''
   okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = ''
   bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
   obkrcd = ''  okkrcd = ''  kkrhkb = ''
   bskart = '0.000') ).

    item_0202 = VALUE #( routkb = 'A' kabtkb = '08' obsycd = '55113'  okykcd = '01110103' hinmcd = '9999Z11128' ).
    item_0224 = VALUE #(  ).

    DATA(lv_expected) = abap_false.
    object_main->chk1020(
     EXPORTING
       i_bsjkkb    = '10'        " 奨励金条件区分
       item_0202   = item_0202
       item_0224   = item_0224
     IMPORTING
     is_valid   = act_res

   ).

    CLEAR: object_main->glb_db_0225.
    cl_abap_unit_assert=>assert_equals(
      EXPORTING
        act  = act_res
        exp  = lv_expected
        msg  = 'ＳＡＰ品目コード  is empty'
        quit = if_aunit_constants=>quit-test
    ).

  ENDMETHOD.

  " ＳＡＰ品目名称
  METHOD testcase_01_17.
    prepare_testdata_set( ).
    DATA:
      item_0202 TYPE zsdt0202,
      item_0224 TYPE zsdt0224,
      act_res   TYPE abap_bool.

    item_0202 = VALUE #( routkb = 'A' kabtkb = '08' obsycd = '55113'  okykcd = '01110103'  hinmcd = '9999Z10029' ).
    item_0224 = VALUE #(  ).

    DATA(lv_expected) = abap_false.
    object_main->chk1020(
     EXPORTING
       i_bsjkkb    = '10'        " 奨励金条件区分
       item_0202   = item_0202
       item_0224   = item_0224
     IMPORTING
     is_valid   = act_res

   ).

    cl_abap_unit_assert=>assert_equals(
      EXPORTING
        act  = act_res
        exp  = lv_expected
        msg  = 'ＳＡＰ品目名称 is empty'
        quit = if_aunit_constants=>quit-test
    ).

  ENDMETHOD.

  " 現場名称
  METHOD testcase_01_18.
    prepare_testdata_set( ).
    DATA:
      item_0202 TYPE zsdt0202,
      item_0224 TYPE zsdt0224,
      act_res   TYPE abap_bool.

    item_0202 = VALUE #( routkb = 'A' kabtkb = '08' obsycd = '55113'  okykcd = '01110103' gbbpnm = 'test' hinmcd = '9999Z10028' ).
    item_0224 = VALUE #(  ).

    object_main->glb_db_0225 = VALUE #( ( bsjkkb = '10' bsjnkb = '40' bsjnnm = '配送料DP1：◇構造資材◇'
    bstpnm = '旭　本番用　2018年3月から'
    tomndt = '000000'
    rtchkb = 'A'  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
    bsksfg = ''
    obks01 = '55113'  obks02 = '55113'  obks03 = '55113'  obks04 = '55113'  obks05 = '55113'
    obks06 = '55113'  obks07 = '55113'  obks08 = '55113'  obks09 = '55113'  obks10 = '55113'
    okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = ''
    okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = ''
    bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
    obkrcd = ''  okkrcd = ''  kkrhkb = ''
    bskart = '0.000') ).

    DATA(lv_expected) = abap_false.
    object_main->chk1020(
     EXPORTING
       i_bsjkkb    = '10'        " 奨励金条件区分
       item_0202   = item_0202
       item_0224   = item_0224
     IMPORTING
     is_valid   = act_res

   ).
    CLEAR: object_main->glb_db_0225.
    cl_abap_unit_assert=>assert_equals(
      EXPORTING
        act  = act_res
        exp  = lv_expected
        msg  = '現場名称 is empty'
        quit = if_aunit_constants=>quit-test
    ).

  ENDMETHOD.

  METHOD testcase_01_19.
    prepare_testdata_set( ).
    CLEAR: object_main->glb_db_0225.

    DATA:
      item_0202     TYPE zsdt0202,
      item_0224     TYPE zsdt0224,
      exp_item_0224 TYPE STANDARD TABLE OF zsdt0224,
      exp_item_0225 TYPE STANDARD TABLE OF zsdt0225,
      is_valid      TYPE abap_bool,
      exp_res       TYPE i,
      act_res       TYPE i.

    item_0202 = VALUE #(  ).
    item_0224 = VALUE #(  ).
    SELECT bstpkb, frmndt
    FROM zsdt0224
    WHERE bstpkb = 'A1' AND bsshkb = '20' AND zdelflg <> 'X'
    ORDER BY frmndt DESCENDING
    INTO CORRESPONDING FIELDS OF TABLE @exp_item_0224.
    READ TABLE exp_item_0224 INTO DATA(fs_0224) WITH KEY frmndt = '201401'.
    IF sy-subrc = 0.
      SELECT bstpkb
       FROM zsdt0225
       WHERE bstpkb = @fs_0224-bstpkb AND frmndt = @fs_0224-frmndt AND zdelflg <> 'X'
       INTO TABLE @exp_item_0225.
      IF sy-subrc = 0.
        exp_res = lines( exp_item_0225 ).
      ENDIF.
    ENDIF.
    object_main->chk1020(
     EXPORTING
       i_bsjkkb    = '20'        " 奨励金条件区分
       item_0202   = item_0202
       item_0224   = item_0224
     IMPORTING
     is_valid   = is_valid
   ).
    LOOP AT object_main->glb_db_0225 INTO DATA(item) WHERE bsjkkb = '20' AND frmndt = '201401'.
      act_res += 1.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
      EXPORTING
        act  = act_res
        exp  = exp_res
        msg  = 'Only records within date range should be processed'
        quit = if_aunit_constants=>quit-test
    ).

  ENDMETHOD.

  METHOD testcase_01_20.
    prepare_testdata_item0225( ).
    CLEAR: object_main->glb_db_0225.
    DATA:
      item_0202 TYPE zsdt0202,
      item_0224 TYPE zsdt0224,
      is_valid  TYPE abap_bool,
      act_res   TYPE i.

    item_0202 = VALUE #(  ).
    item_0224 = VALUE #(  ).

    object_main->chk1020(
     EXPORTING
       i_bsjkkb    = '20'        " 奨励金条件区分
       item_0202   = item_0202
       item_0224   = item_0224
     IMPORTING
     is_valid   = is_valid
   ).
    LOOP AT object_main->glb_db_0225 INTO DATA(item) WHERE bsjkkb = '20' AND frmndt = '201401'.
      act_res += 1.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
      EXPORTING
        act  = act_res
        exp  = 0
        msg  = 'procd handles empty 0225 data correctly'
        quit = if_aunit_constants=>quit-test
    ).
  ENDMETHOD.

  METHOD testcase_01_21.
    prepare_testdata_set( ).
    DATA:
      item_0202 TYPE zsdt0202,
      item_0224 TYPE zsdt0224,
      act_res   TYPE abap_bool.

    item_0202 = VALUE #( routkb = '' ).
    item_0224 = VALUE #(  ).

    DATA(lv_expected) = abap_false.
    object_main->chk1020(
     EXPORTING
       i_bsjkkb    = '20'        " 奨励金条件区分
       item_0202   = item_0202
       item_0224   = item_0224
     IMPORTING
     is_valid   = act_res

   ).

    cl_abap_unit_assert=>assert_equals(
      EXPORTING
        act  = act_res
        exp  = lv_expected
        msg  = 'Routkb is empty'
        quit = if_aunit_constants=>quit-test
    ).

  ENDMETHOD.

  METHOD testcase_01_22.
    prepare_testdata_set( ).
    DATA:
      item_0202 TYPE zsdt0202,
      item_0224 TYPE zsdt0224,
      act_res   TYPE abap_bool.

    item_0202 = VALUE #( routkb = 'A' kabtkb = '' ).
    item_0224 = VALUE #(  ).

    DATA(lv_expected) = abap_false.
    object_main->chk1020(
     EXPORTING
       i_bsjkkb    = '20'        " 奨励金条件区分
       item_0202   = item_0202
       item_0224   = item_0224
     IMPORTING
     is_valid   = act_res

   ).

    cl_abap_unit_assert=>assert_equals(
      EXPORTING
        act  = act_res
        exp  = lv_expected
        msg  = 'Kabtkb is empty'
        quit = if_aunit_constants=>quit-test
    ).

  ENDMETHOD.

  METHOD testcase_01_23.
    prepare_testdata_set( ).
    DATA:
      item_0202 TYPE zsdt0202,
      item_0224 TYPE zsdt0224,
      act_res   TYPE abap_bool.

    item_0202 = VALUE #( routkb = 'A' kabtkb = '08' obsycd = '55114' ).
    item_0224 = VALUE #(  ).

    DATA(lv_expected) = abap_false.
    object_main->chk1020(
     EXPORTING
       i_bsjkkb    = '20'        " 奨励金条件区分
       item_0202   = item_0202
       item_0224   = item_0224
     IMPORTING
     is_valid   = act_res

   ).

    cl_abap_unit_assert=>assert_equals(
      EXPORTING
        act  = act_res
        exp  = lv_expected
        msg  = 'Obsycd is empty'
        quit = if_aunit_constants=>quit-test
    ).

  ENDMETHOD.

  METHOD testcase_01_24.
    prepare_testdata_set( ).
    DATA:
      item_0202 TYPE zsdt0202,
      item_0224 TYPE zsdt0224,
      act_res   TYPE abap_bool.

    item_0202 = VALUE #( routkb = 'A' kabtkb = '08' obsycd = '55113'  okykcd = '01110104' ).
    item_0224 = VALUE #(  ).

    DATA(lv_expected) = abap_false.
    object_main->chk1020(
     EXPORTING
       i_bsjkkb    = '20'        " 奨励金条件区分
       item_0202   = item_0202
       item_0224   = item_0224
     IMPORTING
     is_valid   = act_res

   ).

    cl_abap_unit_assert=>assert_equals(
      EXPORTING
        act  = act_res
        exp  = lv_expected
        msg  = 'Okykcd is empty'
        quit = if_aunit_constants=>quit-test
    ).

  ENDMETHOD.

  " 元請指定
  METHOD  testcase_01_25.
    prepare_testdata_set( ).
    DATA:
      item_0202 TYPE zsdt0202,
      item_0224 TYPE zsdt0224,
      act_res   TYPE abap_bool.


    object_main->glb_db_0225 = VALUE #( ( bsjkkb = '20' bsjnkb = '10' bsjnnm = 'test'
     bstpnm = '旭　本番用　2018年3月から'
    tomndt = '000000'
    rtchkb = 'A'  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
    bsksfg = ''
    obks01 = '55113'  obks02 = '55113'  obks03 = '55113'  obks04 = '55113'  obks05 = '55113'
    obks06 = '55113'  obks07 = '55113'  obks08 = '55113'  obks09 = '55113'  obks10 = '55113'
    okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = ''
    okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = ''
    bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
    obkrcd = ''  okkrcd = ''  kkrhkb = ''
    bskart = '0.000') ).

    item_0202 = VALUE #( routkb = 'A' kabtkb = '08' obsycd = '55113'  okykcd = '01110103' mubpnm = 'Test' ).
    item_0224 = VALUE #(  ).

    DATA(lv_expected) = abap_false.
    object_main->chk1020(
     EXPORTING
       i_bsjkkb    = '20'        " 奨励金条件区分
       item_0202   = item_0202
       item_0224   = item_0224
     IMPORTING
     is_valid   = act_res

   ).
    CLEAR: object_main->glb_db_0225.
    cl_abap_unit_assert=>assert_equals(
      EXPORTING
        act  = act_res
        exp  = lv_expected
        msg  = '元請指定 is empty'
        quit = if_aunit_constants=>quit-test
    ).

  ENDMETHOD.

  " ＳＡＰ品目コード
  METHOD testcase_01_26.
    prepare_testdata_set( ).
    DATA:
      item_0202 TYPE zsdt0202,
      item_0224 TYPE zsdt0224,
      act_res   TYPE abap_bool.

    object_main->glb_db_0225 = VALUE #( ( bsjkkb = '20' bsjnkb = '30' bsjnnm = 'test'
    bstpnm = '旭　本番用　2018年3月から'
   tomndt = '000000'
   rtchkb = 'A'  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
   bsksfg = ''
   obks01 = '55113'  obks02 = '55113'  obks03 = '55113'  obks04 = '55113'  obks05 = '55113'
   obks06 = '55113'  obks07 = '55113'  obks08 = '55113'  obks09 = '55113'  obks10 = '55113'
   okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = ''
   okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = ''
   bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
   obkrcd = ''  okkrcd = ''  kkrhkb = ''
   bskart = '0.000') ).

    item_0202 = VALUE #( routkb = 'A' kabtkb = '08' obsycd = '55113'  okykcd = '01110103' hinmcd = '9999Z11128' ).
    item_0224 = VALUE #(  ).

    DATA(lv_expected) = abap_false.
    object_main->chk1020(
     EXPORTING
       i_bsjkkb    = '20'        " 奨励金条件区分
       item_0202   = item_0202
       item_0224   = item_0224
     IMPORTING
     is_valid   = act_res

   ).

    CLEAR: object_main->glb_db_0225.
    cl_abap_unit_assert=>assert_equals(
      EXPORTING
        act  = act_res
        exp  = lv_expected
        msg  = 'ＳＡＰ品目コード  is empty'
        quit = if_aunit_constants=>quit-test
    ).

  ENDMETHOD.

  " ＳＡＰ品目名称
  METHOD testcase_01_27.
    prepare_testdata_set( ).
    DATA:
      item_0202 TYPE zsdt0202,
      item_0224 TYPE zsdt0224,
      act_res   TYPE abap_bool.

    item_0202 = VALUE #( routkb = 'A' kabtkb = '08' obsycd = '55113'  okykcd = '01110103'  hinmcd = '9999Z10029' ).
    item_0224 = VALUE #(  ).

    DATA(lv_expected) = abap_false.
    object_main->chk1020(
     EXPORTING
       i_bsjkkb    = '20'        " 奨励金条件区分
       item_0202   = item_0202
       item_0224   = item_0224
     IMPORTING
     is_valid   = act_res

   ).

    cl_abap_unit_assert=>assert_equals(
      EXPORTING
        act  = act_res
        exp  = lv_expected
        msg  = 'ＳＡＰ品目名称 is empty'
        quit = if_aunit_constants=>quit-test
    ).

  ENDMETHOD.

  " 現場名称
  METHOD testcase_01_28.
    prepare_testdata_set( ).
    DATA:
      item_0202 TYPE zsdt0202,
      item_0224 TYPE zsdt0224,
      act_res   TYPE abap_bool.

    item_0202 = VALUE #( routkb = 'A' kabtkb = '08' obsycd = '55113'  okykcd = '01110103' gbbpnm = 'test' hinmcd = '9999Z10028' ).
    item_0224 = VALUE #(  ).

    object_main->glb_db_0225 = VALUE #( ( bsjkkb = '20' bsjnkb = '40' bsjnnm = '配送料DP1：◇構造資材◇'
    bstpnm = '旭　本番用　2018年3月から'
    tomndt = '000000'
    rtchkb = 'A'  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
    bsksfg = ''
    obks01 = '55113'  obks02 = '55113'  obks03 = '55113'  obks04 = '55113'  obks05 = '55113'
    obks06 = '55113'  obks07 = '55113'  obks08 = '55113'  obks09 = '55113'  obks10 = '55113'
    okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = ''
    okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = ''
    bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
    obkrcd = ''  okkrcd = ''  kkrhkb = ''
    bskart = '0.000') ).

    DATA(lv_expected) = abap_false.
    object_main->chk1020(
     EXPORTING
       i_bsjkkb    = '20'        " 奨励金条件区分
       item_0202   = item_0202
       item_0224   = item_0224
     IMPORTING
     is_valid   = act_res

   ).
    CLEAR: object_main->glb_db_0225.
    cl_abap_unit_assert=>assert_equals(
      EXPORTING
        act  = act_res
        exp  = lv_expected
        msg  = '現場名称 is empty'
        quit = if_aunit_constants=>quit-test
    ).

  ENDMETHOD.

  METHOD testcase_01_29.
    prepare_testdata_set( ).
    CLEAR: object_main->glb_db_0225.

    DATA:
      item_0202     TYPE zsdt0202,
      item_0224     TYPE zsdt0224,
      exp_item_0224 TYPE STANDARD TABLE OF zsdt0224,
      exp_item_0225 TYPE STANDARD TABLE OF zsdt0225,
      is_valid      TYPE abap_bool,
      exp_res       TYPE i,
      act_res       TYPE i.

    item_0202 = VALUE #(  ).
    item_0224 = VALUE #(  ).
    SELECT bstpkb, frmndt
    FROM zsdt0224
    WHERE bstpkb = 'A1' AND bsshkb = '30' AND zdelflg <> 'X'
    ORDER BY frmndt DESCENDING
    INTO CORRESPONDING FIELDS OF TABLE @exp_item_0224.
    READ TABLE exp_item_0224 INTO DATA(fs_0224) WITH KEY frmndt = '201401'.
    IF sy-subrc = 0.
      SELECT bstpkb
       FROM zsdt0225
       WHERE bstpkb = @fs_0224-bstpkb AND frmndt = @fs_0224-frmndt AND zdelflg <> 'X'
       INTO TABLE @exp_item_0225.
      IF sy-subrc = 0.
        exp_res = lines( exp_item_0225 ).
      ENDIF.
    ENDIF.

    object_main->chk1020(
     EXPORTING
       i_bsjkkb    = '30'        " 奨励金条件区分
       item_0202   = item_0202
       item_0224   = item_0224
     IMPORTING
     is_valid   = is_valid
   ).
    LOOP AT object_main->glb_db_0225 INTO DATA(item) WHERE bsjkkb = '30' AND frmndt = '201401'.
      act_res += 1.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
      EXPORTING
        act  = act_res
        exp  = exp_res
        msg  = 'Only records within date range should be processed'
        quit = if_aunit_constants=>quit-test
    ).

  ENDMETHOD.

  METHOD testcase_01_30.
    prepare_testdata_set( ).
    CLEAR: object_main->glb_db_0225.
    DATA:
      item_0202 TYPE zsdt0202,
      item_0224 TYPE zsdt0224,
      is_valid  TYPE abap_bool,
      act_res   TYPE i.

    item_0202 = VALUE #(  ).
    item_0224 = VALUE #(  ).
    object_main->chk1020(
     EXPORTING
       i_bsjkkb    = '10'        " 奨励金条件区分
       item_0202   = item_0202
       item_0224   = item_0224
     IMPORTING
     is_valid   = is_valid
   ).
    LOOP AT object_main->glb_db_0225 INTO DATA(item) WHERE bsjkkb = '10' AND frmndt = '201401'.
      act_res += 1.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
      EXPORTING
        act  = act_res
        exp  = 0
        msg  = 'procd handles empty 0225 data correctly'
        quit = if_aunit_constants=>quit-test
    ).
  ENDMETHOD.

  " 集約条件チェック
  " 旧部署01個別集約 i_bsshkb = '10'
  METHOD testcase_01_31.
    prepare_testdata_set( ).
    DATA: item_0202    TYPE zsdt0202,
          act_wxbsgec2 TYPE c LENGTH 20 VALUE 'INITIAL',
          act_wxbsgen2 TYPE c LENGTH 42 VALUE 'INITIAL',
          exp_wxbsgec2 TYPE c LENGTH 20 VALUE 'INITIAL',
          exp_wxbsgen2 TYPE c LENGTH 42 VALUE 'INITIAL',
          act_egbucd   TYPE char4,
          exp_egbucd   TYPE char4.

    item_0202 = VALUE #( routkb = 'A' kabtkb = '08' obsycd = '55113'  okykcd = '01110103' gbbpnm = 'test' egbucd = 'A252' ).
    CLEAR: object_main->glb_db_0225.

    object_main->glb_db_0225 = VALUE #(
    ( client = '310' bstpkb = 'A1' frmndt = '201401' bsjkkb = '30' bstpsq = '0003'
    obks01 = '55113' obks02 = '55113' obks03 = '55113' obks04 = '55113' obks05 = '55113'
    obks06 = '55113' obks07 = '55113' obks08 = '55113' obks09 = '55113' obks10 = '55113'
    bskscd = '1110103'  bsksnm = 'Test'  ebkscd = 'A252'
    )
    ).

    object_main->chk30(
      EXPORTING
        i_bsshkb = '10'
      CHANGING
        item_0202 = item_0202
        wxbsgec2 = act_wxbsgec2
        wxbsgen2 = act_wxbsgen2
    ).

    exp_egbucd = 'A252'.
    exp_wxbsgec2 = '1110103'.
    exp_wxbsgen2 = 'Test'.
    cl_abap_unit_assert=>assert_equals(
      act = item_0202-egbucd
      exp = exp_egbucd
      msg = '部署別 = 10 and 営業部 have data').

    cl_abap_unit_assert=>assert_equals(
    act = act_wxbsgec2
    exp = exp_wxbsgec2
    msg = '部署別 = 10 and 汎用コード have data').

    cl_abap_unit_assert=>assert_equals(
    act = act_wxbsgen2
    exp = exp_wxbsgen2
    msg = '部署別 = 10 and 汎用名称 have data').

  ENDMETHOD.

  METHOD testcase_01_32.
    prepare_testdata_set( ).
    DATA: item_0202    TYPE zsdt0202,
          act_wxbsgec2 TYPE c LENGTH 20 VALUE 'INITIAL',
          act_wxbsgen2 TYPE c LENGTH 42 VALUE 'INITIAL',
          exp_wxbsgec2 TYPE c LENGTH 20 VALUE 'INITIAL',
          exp_wxbsgen2 TYPE c LENGTH 42 VALUE 'INITIAL',
          act_egbucd   TYPE char4,
          exp_egbucd   TYPE char4.

    item_0202 = VALUE #( routkb = 'A' kabtkb = '08' obsycd = '55113'  okykcd = '01110103' gbbpnm = 'test' egbucd = 'A252' ).
    CLEAR: object_main->glb_db_0225.

    object_main->glb_db_0225 = VALUE #(
    ( client = '310' bstpkb = 'A1' frmndt = '201401' bsjkkb = '30' bstpsq = '0003'
    obks01 = '55113' obks02 = '55113' obks03 = '55113' obks04 = '55113' obks05 = '55113'
    obks06 = '55113' obks07 = '55113' obks08 = '55113' obks09 = '55113' obks10 = '55113'
    bskscd = '1110103'  bsksnm = 'Test'  ebkscd = ''
    )
    ).

    object_main->chk30(
      EXPORTING
        i_bsshkb = '10'
      CHANGING
        item_0202 = item_0202
        wxbsgec2 = act_wxbsgec2
        wxbsgen2 = act_wxbsgen2
    ).

    exp_egbucd = 'A252'.
    exp_wxbsgec2 = '1110103'.
    exp_wxbsgen2 = 'Test'.

    cl_abap_unit_assert=>assert_equals(
    act = act_wxbsgec2
    exp = exp_wxbsgec2
    msg = '部署別 = 10 and 汎用コード have data').

    cl_abap_unit_assert=>assert_equals(
    act = act_wxbsgen2
    exp = exp_wxbsgen2
    msg = '部署別 = 10 and 汎用名称 have data').

  ENDMETHOD.

  METHOD testcase_01_33.
    prepare_testdata_set( ).
    DATA: item_0202    TYPE zsdt0202,
          act_wxbsgec2 TYPE c LENGTH 20 VALUE 'INITIAL',
          act_wxbsgen2 TYPE c LENGTH 42 VALUE 'INITIAL',
          exp_wxbsgec2 TYPE c LENGTH 20 VALUE 'INITIAL',
          exp_wxbsgen2 TYPE c LENGTH 42 VALUE 'INITIAL',
          act_egbucd   TYPE char4,
          exp_egbucd   TYPE char4.

    item_0202 = VALUE #( routkb = 'A' kabtkb = '08' obsycd = '55113'  okykcd = '01110103' gbbpnm = 'test' egbucd = 'A252' ).
    CLEAR: object_main->glb_db_0225.

    object_main->glb_db_0225 = VALUE #(
    ( client = '310' bstpkb = 'A1' frmndt = '201401' bsjkkb = '30' bstpsq = '0003' obks01 = '55113'
    okks01 = '01110103' okks02 = '01110103' okks03 = '01110103' okks04 = '01110103' okks05 = '01110103'
    okks06 = '01110103' okks07 = '01110103' okks08 = '01110103' okks09 = '01110103' okks10 = '01110103'
    bskscd = '1110103'  bsksnm = 'Test'  ebkscd = 'A252'
    )
    ).

    object_main->chk30(
      EXPORTING
        i_bsshkb = '20'
      CHANGING
        item_0202 = item_0202
        wxbsgec2 = act_wxbsgec2
        wxbsgen2 = act_wxbsgen2
    ).

    exp_egbucd = 'A252'.
    exp_wxbsgec2 = '1110103'.
    exp_wxbsgen2 = 'Test'.

    cl_abap_unit_assert=>assert_equals(
      act = item_0202-egbucd
      exp = exp_egbucd
      msg = '客先別 = 20 and 営業部 have data').

    cl_abap_unit_assert=>assert_equals(
    act = act_wxbsgec2
    exp = exp_wxbsgec2
    msg = '客先別 = 20 and 汎用コード have data').

    cl_abap_unit_assert=>assert_equals(
    act = act_wxbsgen2
    exp = exp_wxbsgen2
    msg = '客先別 = 20 and 汎用名称 have data').

  ENDMETHOD.

  METHOD testcase_01_34.
    prepare_testdata_set( ).
    DATA: item_0202    TYPE zsdt0202,
          act_wxbsgec2 TYPE c LENGTH 20 VALUE 'INITIAL',
          act_wxbsgen2 TYPE c LENGTH 42 VALUE 'INITIAL',
          exp_wxbsgec2 TYPE c LENGTH 20 VALUE 'INITIAL',
          exp_wxbsgen2 TYPE c LENGTH 42 VALUE 'INITIAL',
          act_egbucd   TYPE char4,
          exp_egbucd   TYPE char4.

    item_0202 = VALUE #( routkb = 'A' kabtkb = '08' obsycd = '55113'  okykcd = '01110103' gbbpnm = 'test' egbucd = 'A252' ).
    CLEAR: object_main->glb_db_0225.

    object_main->glb_db_0225 = VALUE #(
    ( client = '310' bstpkb = 'A1' frmndt = '201401' bsjkkb = '30' bstpsq = '0003' obks01 = '55113'
    okks01 = '01110103' okks02 = '01110103' okks03 = '01110103' okks04 = '01110103' okks05 = '01110103'
    okks06 = '01110103' okks07 = '01110103' okks08 = '01110103' okks09 = '01110103' okks10 = '01110103'
    bskscd = '1110103'  bsksnm = 'Test'  ebkscd = ''
    )
    ).

    object_main->chk30(
      EXPORTING
        i_bsshkb = '10'
      CHANGING
        item_0202 = item_0202
        wxbsgec2 = act_wxbsgec2
        wxbsgen2 = act_wxbsgen2
    ).

    exp_egbucd = 'A252'.
    exp_wxbsgec2 = '1110103'.
    exp_wxbsgen2 = 'Test'.

    cl_abap_unit_assert=>assert_equals(
    act = act_wxbsgec2
    exp = exp_wxbsgec2
    msg = '客先別 = 20 and 汎用コード have data').

    cl_abap_unit_assert=>assert_equals(
    act = act_wxbsgen2
    exp = exp_wxbsgen2
    msg = '客先別 = 20 and 汎用名称 have data').

  ENDMETHOD.
  " 旧部署01個別集約

  METHOD testcase_01_35.
    prepare_testdata_set( ).
    DATA: item_0202    TYPE zsdt0202,
          act_wxbsgec2 TYPE c LENGTH 20 VALUE 'INITIAL',
          act_wxbsgen2 TYPE c LENGTH 42 VALUE 'INITIAL',
          exp_wxbsgec2 TYPE c LENGTH 20 VALUE 'INITIAL',
          exp_wxbsgen2 TYPE c LENGTH 42 VALUE 'INITIAL'.

    item_0202 = VALUE #( routkb = 'A' kabtkb = '08' obsycd = '55114'  okykcd = '01110103' gbbpnm = 'test' egbucd = 'A251' ).
    CLEAR: object_main->glb_db_0225.

    object_main->glb_db_0225 = VALUE #(
    ( client = '310'
    bstpkb = 'A1'
    frmndt = '201401'
    bsjkkb = '30'
    bstpsq = '0003'
    obks01 = '55113'
    bskscd = '12345'  bsksnm = 'test'  ebkscd = ''
    )
    ).

    object_main->chk30(
      EXPORTING
        i_bsshkb = '10'
      CHANGING
        item_0202 = item_0202
        wxbsgec2 = act_wxbsgec2
        wxbsgen2 = act_wxbsgen2
    ).

    cl_abap_unit_assert=>assert_equals(
      act = act_wxbsgec2
      exp = exp_wxbsgec2
      msg = '旧部別 = 10 and 汎用コード is empty' ).

    cl_abap_unit_assert=>assert_equals(
       act = act_wxbsgen2
       exp = exp_wxbsgen2
       msg = '旧部別 = 10 and 汎用コード is empty' ).

  ENDMETHOD.

  METHOD testcase_01_36.
    prepare_testdata_set( ).
    DATA: item_0202    TYPE zsdt0202,
          act_wxbsgec2 TYPE c LENGTH 20 VALUE 'INITIAL',
          act_wxbsgen2 TYPE c LENGTH 42 VALUE 'INITIAL',
          exp_wxbsgec2 TYPE c LENGTH 20 VALUE 'INITIAL',
          exp_wxbsgen2 TYPE c LENGTH 42 VALUE 'INITIAL'.

    item_0202 = VALUE #( routkb = 'A' kabtkb = '08' obsycd = '55114'  okykcd = '01110104' gbbpnm = 'test' egbucd = 'A251' ).
    CLEAR: object_main->glb_db_0225.

    object_main->glb_db_0225 = VALUE #(
    ( client = '310'
    bstpkb = 'A1'
    frmndt = '201401'
    bsjkkb = '30'
    bstpsq = '0003'
    obks01 = '55113'
    bskscd = '12345'  bsksnm = 'test'  ebkscd = ''
    )
    ).

    object_main->chk30(
      EXPORTING
        i_bsshkb = '10'
      CHANGING
        item_0202 = item_0202
        wxbsgec2 = act_wxbsgec2
        wxbsgen2 = act_wxbsgen2
    ).

    cl_abap_unit_assert=>assert_equals(
      act = act_wxbsgec2
      exp = exp_wxbsgec2
      msg = '客先別 = 20 and 汎用コード is empty' ).

    cl_abap_unit_assert=>assert_equals(
       act = act_wxbsgen2
       exp = exp_wxbsgen2
       msg = '客先別 = 20 and 汎用コード is empty' ).

  ENDMETHOD.

  " wrttp10 WR
  METHOD Testcase_01_37.
    prepare_testdata_item0225( ).

    DATA:
      item_0202 TYPE zsdt0202,
      item_0224 TYPE zsdt0224,
      act_res   TYPE i,
      lv_expted TYPE i.

    object_main->glb_db_0225 = VALUE #( ( client = '310'
   bstpkb = 'A1'
   frmndt = '201401'
   bsjkkb = '40'
   bstpsq = '0000'
   bstpnm = '旭　本番用　2018年3月から'
   tomndt = '000000'
   bsspkb = '21'
   rtchkb = 'A'  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
   bsjnkb = '10'  bsjnnm = '配送料DP1：◇構造資材◇'  bsksfg = ''
   obks01 = 'obks01'  obks02 = 'obks01'  obks03 = 'obks01'  obks04 = 'obks01'  obks05 = 'obks01'
   obks06 = ''  obks07 = ''  obks08 = ''  obks09 = ''  obks10 = ''
   okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = ''
   okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = ''
   bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
   obkrcd = ''  okkrcd = ''  kkrhkb = ''
   bskart = '0.000'
   zdelflg = '' ) ).

    item_0202 = VALUE #( routkb = 'A' kabtkb = '08' obsycd = '55113'  okykcd = '01110103' gbbpnm = 'test' egbucd = 'A251' ).
    item_0224 = VALUE #( bstpkb = 'A1' bstpnm = '旭　本番用　2014年1月から' frmndt = '201401' tomndt = '000000' bstnkb = '30' bsmrkb = '20' bsmtkb = '10' bsshkb = '10'  ).

    object_main->wrttp10(
   EXPORTING
    i_wxgtksym = '201401'          " 月次更新年月
    i_wxbsgec2 = '01'              " 汎用コード
    i_wxbsgen2 = 'bsgen2'          " 汎用名称
    i_wxegbuc2 = '01'              " 営業部コード
    i_wxegbun2 = 'egbun2'          " 営業部名称
    item_0202  = item_0202
    item_0224  = item_0224

).
    lv_expted = 1.
    " glb_it_okb6100
    LOOP AT object_main->glb_it_okb6100 INTO DATA(item) WHERE gtksym = '201401' AND egbucd = '01' AND bsgecd = '01' AND kabtkb = '08' AND kisokb = '10'.
      act_res = act_res + 1.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
    act = act_res
    exp = lv_expted
    msg = 'write in OB6110R01 successful' ).

  ENDMETHOD.

  " wrttp10 UPS
  METHOD testcase_01_38.
    prepare_testdata_set( ).

    DATA:
      item_0202 TYPE zsdt0202,
      item_0224 TYPE zsdt0224,
      act_res   TYPE i,
      lv_expted TYPE i.

    object_main->glb_it_okb6100 = VALUE #( ( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '10' ) ).

    item_0202 = VALUE #( routkb = 'A' kabtkb = '08' obsycd = '55113'  okykcd = '01110103' gbbpnm = 'test' egbucd = 'A251' ).
    item_0224 = VALUE #( bstpkb = 'A1' bstpnm = '旭　本番用　2014年1月から' frmndt = '201401' tomndt = '000000' bstnkb = '30' bsmrkb = '20' bsmtkb = '10' bsshkb = '10'  ).

    object_main->wrttp10(
   EXPORTING
    i_wxgtksym = '201401'          " 月次更新年月
    i_wxbsgec2 = '01'              " 汎用コード
    i_wxbsgen2 = 'bsgen2'          " 汎用名称
    i_wxegbuc2 = '01'              " 営業部コード
    i_wxegbun2 = 'egbun2'          " 営業部名称
    item_0202  = item_0202
    item_0224  = item_0224

).
    lv_expted = 1.
    " glb_it_okb6100
    LOOP AT object_main->glb_it_okb6100 INTO DATA(item) WHERE gtksym = '201401' AND egbucd = '01' AND bsgecd = '01' AND kabtkb = '08' AND kisokb = '10'.
      act_res = act_res + 1.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
    act = act_res
    exp = lv_expted
    msg = 'update in OB6110R01 successful' ).

  ENDMETHOD.

  " 1円
  METHOD testcase_01_39.
    prepare_testdata_set( ).

    DATA:
      act_res   TYPE p,
      lv_expted TYPE p.

    object_main->glb_it_okb6100 = VALUE #( ( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '10' ) ).

    object_main->procmr(
   EXPORTING
    i_bsmtkb = '10'
    i_bsmrkb = '10'
    i_wxbsmrsr = '12345'
   IMPORTING
   rt_wxbsmrsr = act_res

    ).
    lv_expted = 12345.

    cl_abap_unit_assert=>assert_equals(
    act = act_res
    exp = lv_expted
    msg = '整数】丸め区分=10の場合、奨励金金額は丸め処理されず、元の値が保持されること' ).

  ENDMETHOD.

  " 10円
  METHOD testcase_01_40.
    prepare_testdata_set( ).

    DATA:
      act_res   TYPE p DECIMALS 2,
      lv_expted TYPE p.

    object_main->glb_it_okb6100 = VALUE #( ( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '10' ) ).

    object_main->procmr(
   EXPORTING
    i_bsmtkb = '20'
    i_bsmrkb = '20'
    i_wxbsmrsr = '12345'
   IMPORTING
   rt_wxbsmrsr = act_res

    ).
    lv_expted = 12340.

    cl_abap_unit_assert=>assert_equals(
    act = act_res
    exp = lv_expted
    msg = '【10円単位】丸め区分=20の場合、奨励金金額は10円単位で切り捨てされること' ).

  ENDMETHOD.

  " 100円
  METHOD testcase_01_41.
    prepare_testdata_set( ).

    DATA:
      act_res   TYPE p DECIMALS 2,
      lv_expted TYPE p.

    object_main->glb_it_okb6100 = VALUE #( ( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '10' ) ).

    object_main->procmr(
   EXPORTING
    i_bsmtkb = '30'
    i_bsmrkb = '30'
    i_wxbsmrsr = '12345'
   IMPORTING
   rt_wxbsmrsr = act_res

    ).
    lv_expted = 12300.

    cl_abap_unit_assert=>assert_equals(
    act = act_res
    exp = lv_expted
    msg = '【100円単位】丸め区分=30の場合、奨励金金額は100円単位で切り捨てされること' ).

  ENDMETHOD.
  " 1000円
  METHOD testcase_01_42.
    prepare_testdata_set( ).

    DATA:
      act_res   TYPE p DECIMALS 2,
      lv_expted TYPE p DECIMALS 2.

    object_main->glb_it_okb6100 = VALUE #( ( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '10' ) ).

    object_main->procmr(
   EXPORTING
    i_bsmtkb = '40'
    i_bsmrkb = '10'
    i_wxbsmrsr = '12345'
   IMPORTING
   rt_wxbsmrsr = act_res

    ).
    lv_expted = '13000'.

    cl_abap_unit_assert=>assert_equals(
    act = act_res
    exp = lv_expted
    msg = '【1000円単位】丸め区分=40の場合、奨励金金額は1000円単位で補正後、元の金額に復元されること' ).
  ENDMETHOD.
  " 1円
  " 切り上げ
  METHOD testcase_01_43.
    prepare_testdata_set( ).

    DATA:
      act_res   TYPE p DECIMALS 2,
      lv_expted TYPE p.

    object_main->glb_it_okb6100 = VALUE #( ( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '10' ) ).

    object_main->procmr(
       EXPORTING
        i_bsmtkb = '10'
        i_bsmrkb = '10'
        i_wxbsmrsr = '12345'
       IMPORTING
       rt_wxbsmrsr = act_res
    ).
    lv_expted = 12345.

    cl_abap_unit_assert=>assert_equals(
        act = act_res
        exp = lv_expted
    ).
  ENDMETHOD.
  " 1円
  " 切り捨て
  METHOD testcase_01_44.
    prepare_testdata_set( ).

    DATA:
      act_res   TYPE p DECIMALS 2,
      lv_expted TYPE p.

    object_main->glb_it_okb6100 = VALUE #( ( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '10' ) ).

    object_main->procmr(
       EXPORTING
        i_bsmtkb = '10'
        i_bsmrkb = '20'
        i_wxbsmrsr = '12345'
       IMPORTING
       rt_wxbsmrsr = act_res
    ).
    lv_expted = 12345.

    cl_abap_unit_assert=>assert_equals(
        act = act_res
        exp = lv_expted
    ).
  ENDMETHOD.
  " 1円
  " 四捨五入
  METHOD testcase_01_45.
    prepare_testdata_set( ).

    DATA:
      act_res   TYPE p DECIMALS 2,
      lv_expted TYPE p.

    object_main->glb_it_okb6100 = VALUE #( ( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '10' ) ).

    object_main->procmr(
       EXPORTING
        i_bsmtkb = '10'
        i_bsmrkb = '30'
        i_wxbsmrsr = '12345'
       IMPORTING
       rt_wxbsmrsr = act_res
    ).
    lv_expted = 12345.

    cl_abap_unit_assert=>assert_equals(
        act = act_res
        exp = lv_expted
    ).
  ENDMETHOD.
  " 10円
  " 切り上げ
  METHOD testcase_01_46.
    prepare_testdata_set( ).

    DATA:
      act_res   TYPE p DECIMALS 2,
      lv_expted TYPE p.

    object_main->glb_it_okb6100 = VALUE #( ( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '10' ) ).

    object_main->procmr(
       EXPORTING
        i_bsmtkb = '20'
        i_bsmrkb = '10'
        i_wxbsmrsr = '12345'
       IMPORTING
       rt_wxbsmrsr = act_res
    ).
    lv_expted = 12350.

    cl_abap_unit_assert=>assert_equals(
        act = act_res
        exp = lv_expted
    ).
  ENDMETHOD.
  " 10円
  " 切り捨て
  METHOD testcase_01_47.
    prepare_testdata_set( ).

    DATA:
      act_res   TYPE p DECIMALS 2,
      lv_expted TYPE p.

    object_main->glb_it_okb6100 = VALUE #( ( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '10' ) ).

    object_main->procmr(
       EXPORTING
        i_bsmtkb = '20'
        i_bsmrkb = '20'
        i_wxbsmrsr = '12345'
       IMPORTING
       rt_wxbsmrsr = act_res
    ).
    lv_expted = 12340.

    cl_abap_unit_assert=>assert_equals(
        act = act_res
        exp = lv_expted
    ).
  ENDMETHOD.
  " 10円
  " 四捨五入
  METHOD testcase_01_48.
    prepare_testdata_set( ).

    DATA:
      act_res   TYPE p DECIMALS 2,
      lv_expted TYPE p.

    object_main->glb_it_okb6100 = VALUE #( ( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '10' ) ).

    object_main->procmr(
       EXPORTING
        i_bsmtkb = '20'
        i_bsmrkb = '30'
        i_wxbsmrsr = '12345'
       IMPORTING
       rt_wxbsmrsr = act_res
    ).
    lv_expted = 12350.

    cl_abap_unit_assert=>assert_equals(
        act = act_res
        exp = lv_expted
    ).
  ENDMETHOD.
  " 100円
  " 切り上げ
  METHOD testcase_01_49.
    prepare_testdata_set( ).

    DATA:
      act_res   TYPE p DECIMALS 2,
      lv_expted TYPE p.

    object_main->glb_it_okb6100 = VALUE #( ( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '10' ) ).

    object_main->procmr(
       EXPORTING
        i_bsmtkb = '30'
        i_bsmrkb = '10'
        i_wxbsmrsr = '12345'
       IMPORTING
       rt_wxbsmrsr = act_res
    ).
    lv_expted = 12400.

    cl_abap_unit_assert=>assert_equals(
        act = act_res
        exp = lv_expted
    ).
  ENDMETHOD.
  " 100円
  " 切り捨て
  METHOD testcase_01_50.
    prepare_testdata_set( ).

    DATA:
      act_res   TYPE p DECIMALS 2,
      lv_expted TYPE p.

    object_main->glb_it_okb6100 = VALUE #( ( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '10' ) ).

    object_main->procmr(
       EXPORTING
        i_bsmtkb = '30'
        i_bsmrkb = '20'
        i_wxbsmrsr = '12345'
       IMPORTING
       rt_wxbsmrsr = act_res
    ).
    lv_expted = 12300.

    cl_abap_unit_assert=>assert_equals(
        act = act_res
        exp = lv_expted
    ).
  ENDMETHOD.
  " 100円
  " 四捨五入
  METHOD testcase_01_51.
    prepare_testdata_set( ).

    DATA:
      act_res   TYPE p DECIMALS 2,
      lv_expted TYPE p.

    object_main->glb_it_okb6100 = VALUE #( ( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '10' ) ).

    object_main->procmr(
       EXPORTING
        i_bsmtkb = '30'
        i_bsmrkb = '30'
        i_wxbsmrsr = '12345'
       IMPORTING
       rt_wxbsmrsr = act_res
    ).
    lv_expted = 12300.

    cl_abap_unit_assert=>assert_equals(
        act = act_res
        exp = lv_expted
    ).
  ENDMETHOD.
  " 1000円
  " 切り上げ
  METHOD testcase_01_52.
    prepare_testdata_set( ).

    DATA:
      act_res   TYPE p DECIMALS 2,
      lv_expted TYPE p.

    object_main->glb_it_okb6100 = VALUE #( ( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '10' ) ).

    object_main->procmr(
       EXPORTING
        i_bsmtkb = '40'
        i_bsmrkb = '10'
        i_wxbsmrsr = '12345'
       IMPORTING
       rt_wxbsmrsr = act_res
    ).
    lv_expted = 13000.

    cl_abap_unit_assert=>assert_equals(
        act = act_res
        exp = lv_expted
    ).
  ENDMETHOD.
  " 1000円
  " 切り捨て
  METHOD testcase_01_53.
    prepare_testdata_set( ).

    DATA:
      act_res   TYPE p DECIMALS 2,
      lv_expted TYPE p.

    object_main->glb_it_okb6100 = VALUE #( ( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '10' ) ).

    object_main->procmr(
       EXPORTING
        i_bsmtkb = '40'
        i_bsmrkb = '20'
        i_wxbsmrsr = '12345'
       IMPORTING
       rt_wxbsmrsr = act_res
    ).
    lv_expted = 12000.

    cl_abap_unit_assert=>assert_equals(
        act = act_res
        exp = lv_expted
    ).
  ENDMETHOD.
  " 1000円
  " 四捨五入
  METHOD testcase_01_54.
    prepare_testdata_set( ).

    DATA:
      act_res   TYPE p DECIMALS 2,
      lv_expted TYPE p.

    object_main->glb_it_okb6100 = VALUE #( ( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '10' ) ).

    object_main->procmr(
       EXPORTING
        i_bsmtkb = '40'
        i_bsmrkb = '30'
        i_wxbsmrsr = '12345'
       IMPORTING
       rt_wxbsmrsr = act_res
    ).
    lv_expted = 12000.

    cl_abap_unit_assert=>assert_equals(
        act = act_res
        exp = lv_expted
    ).
  ENDMETHOD.

  METHOD testcase_01_55.
    prepare_testdata_set( ).

    DATA item_0202 TYPE TABLE OF zsdt0202.
    item_0202 = VALUE #(
        ( bkenct = 'B25X023563' judnno = 'A252063997' jugysq = '3' hbsocd = 'A000' rtchcd = '00' shnbcd = '00' sitncd = 'A25'
          egbucd = 'A252' obsycd = '55113' obsynm = '埼玉A' jdbrno = 'A2' gbbpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸﾞ' gadrcd = '11101' gadscd = '11'
          nobpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸ' tkykcd = '1172' tkkjnm = '所沢資材' sktncd = 'ZZZZ' mubpnm = '配送料DP1：◇構造資材◇'
          hinmcd = '9999Z10028' sehnnm = '配送料DP1：◇構造資材◇' syuksr = '1' juchdt = '20140320' bpnodt = '20140315' hdbucd = 'DP1'
          hcbucd = 'DP19999' hsbucd = 'DP199999999' kabtkb = '08' bnrikb = '90' sysxdt = '20140321' syordt = '20141231' okykcd = '01110103'
          okyknm = '旭　東京' bpurtn = '1500.00' bpurkg = '1500.00' juchcd = '107480103B' bpjtdt = '20140321' gtksdt = '20140331'
          routkb = 'A' zdelflg = '' )
    ).
    sql_test_environment->insert_test_data( i_data = item_0202 ).

    object_main->procd(
       EXPORTING
        i_bsshkb = '10'
        i_bstpkb = 'A1'
    ).

    READ TABLE object_main->glb_db_0202
        INTO DATA(ls_0202)
        WITH KEY syordt = '20141231'.
    DATA(act_res) = 0.
    IF sy-subrc = 0.
        act_res = 1.
    ENDIF.

    DATA(lv_expected) = 1.

    cl_abap_unit_assert=>assert_equals(
        act = act_res
        exp = lv_expected
    ).
  ENDMETHOD.

  METHOD testcase_01_56.
    prepare_testdata_set( ).

    DATA item_0202 TYPE TABLE OF zsdt0202.
    item_0202 = VALUE #(
        ( bkenct = 'B25X023563' judnno = 'A252063997' jugysq = '3' hbsocd = 'A000' rtchcd = '00' shnbcd = '00' sitncd = 'A25'
          egbucd = 'A252' obsycd = '55113' obsynm = '埼玉A' jdbrno = 'A2' gbbpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸﾞ' gadrcd = '11101' gadscd = '11'
          nobpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸ' tkykcd = '1172' tkkjnm = '所沢資材' sktncd = 'ZZZZ' mubpnm = '配送料DP1：◇構造資材◇'
          hinmcd = '9999Z10028' sehnnm = '配送料DP1：◇構造資材◇' syuksr = '1' juchdt = '20140320' bpnodt = '20140315' hdbucd = 'DP1'
          hcbucd = 'DP19999' hsbucd = 'DP199999999' kabtkb = '08' bnrikb = '90' sysxdt = '20140321' syordt = '20150101' okykcd = '01110103'
          okyknm = '旭　東京' bpurtn = '1500.00' bpurkg = '1500.00' juchcd = '107480103B' bpjtdt = '20140321' gtksdt = '20140331'
          routkb = 'A' zdelflg = '' )
    ).
    sql_test_environment->insert_test_data( i_data = item_0202 ).

    object_main->procd(
       EXPORTING
        i_bsshkb = '10'
        i_bstpkb = 'A1'
    ).

    READ TABLE object_main->glb_db_0202
        INTO DATA(ls_0202)
        WITH KEY syordt = '20150101'.
    DATA(act_res) = 0.
    IF sy-subrc = 0.
        act_res = 1.
    ENDIF.

    DATA(lv_expected) = 0.

    cl_abap_unit_assert=>assert_equals(
        act = act_res
        exp = lv_expected
    ).
  ENDMETHOD.

  METHOD testcase_01_57.
    prepare_testdata_set( ).

    DATA item_0202 TYPE TABLE OF zsdt0202.
    item_0202 = VALUE #(
        ( bkenct = 'B25X023563' judnno = 'A252063997' jugysq = '3' hbsocd = 'A000' rtchcd = '00' shnbcd = '00' sitncd = 'A25'
          egbucd = 'A252' obsycd = '55113' obsynm = '埼玉A' jdbrno = 'A2' gbbpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸﾞ' gadrcd = '11101' gadscd = '11'
          nobpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸ' tkykcd = '1172' tkkjnm = '所沢資材' sktncd = 'ZZZZ' mubpnm = '配送料DP1：◇構造資材◇'
          hinmcd = '9999Z10028' sehnnm = '配送料DP1：◇構造資材◇' syuksr = '1' juchdt = '20140320' bpnodt = '20140315' hdbucd = 'DP1'
          hcbucd = 'DP19999' hsbucd = 'DP199999999' kabtkb = '08' bnrikb = '90' sysxdt = '20140321' syordt = '20141231' okykcd = '01110103'
          okyknm = '旭　東京' bpurtn = '1500.00' bpurkg = '0' juchcd = '107480103B' bpjtdt = '20140321' gtksdt = '20140331'
          routkb = 'A' zdelflg = '' )
    ).
    sql_test_environment->insert_test_data( i_data = item_0202 ).

    object_main->procd(
       EXPORTING
        i_bsshkb = '10'
        i_bstpkb = 'A1'
    ).
    DATA(lv_expected) = 0.

    READ TABLE object_main->glb_it_okb6100
        INTO DATA(ls_okb6100)
        WITH KEY gtksym = '201412'.
    DATA(act_res) = xsdbool(
        ls_okb6100-bpurkg = lv_expected
    ).

    cl_abap_unit_assert=>assert_equals(
        act = act_res
        exp = abap_true
    ).
  ENDMETHOD.

  METHOD testcase_01_58.
    prepare_testdata_set( ).

    DATA item_0202 TYPE TABLE OF zsdt0202.
    item_0202 = VALUE #(
        ( bkenct = 'B25X023563' judnno = 'A252063997' jugysq = '3' hbsocd = 'A000' rtchcd = '00' shnbcd = '00' sitncd = 'A25'
          egbucd = 'A252' obsycd = '55113' obsynm = '埼玉A' jdbrno = 'A2' gbbpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸﾞ' gadrcd = '11101' gadscd = '11'
          nobpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸ' tkykcd = '1172' tkkjnm = '所沢資材' sktncd = 'ZZZZ' mubpnm = '配送料DP1：◇構造資材◇'
          hinmcd = '9999Z10028' sehnnm = '配送料DP1：◇構造資材◇' syuksr = '1' juchdt = '20140320' bpnodt = '20140315' hdbucd = 'DP1'
          hcbucd = 'DP19999' hsbucd = 'DP199999999' kabtkb = '08' bnrikb = '90' sysxdt = '20140321' syordt = '20141231' okykcd = '01110103'
          okyknm = '旭　東京' bpurtn = '1500.00' bpurkg = '-1500' juchcd = '107480103B' bpjtdt = '20140321' gtksdt = '20140331'
          routkb = 'A' zdelflg = '' )
        ( bkenct = 'B25X023563' judnno = 'A252063997' jugysq = '4' hbsocd = 'A000' rtchcd = '00' shnbcd = '00' sitncd = 'A25'
          egbucd = 'A252' obsycd = '55113' obsynm = '埼玉A' jdbrno = 'A2' gbbpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸﾞ' gadrcd = '11101' gadscd = '11'
          nobpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸ' tkykcd = '1172' tkkjnm = '所沢資材' sktncd = 'ZZZZ' mubpnm = '配送料DP1：◇構造資材◇'
          hinmcd = '9999Z10028' sehnnm = '配送料DP1：◇構造資材◇' syuksr = '1' juchdt = '20140320' bpnodt = '20140315' hdbucd = 'DP1'
          hcbucd = 'DP19999' hsbucd = 'DP199999999' kabtkb = '08' bnrikb = '90' sysxdt = '20140321' syordt = '20141231' okykcd = '01110103'
          okyknm = '旭　東京' bpurtn = '1500.00' bpurkg = '-1000' juchcd = '107480103B' bpjtdt = '20140321' gtksdt = '20140331'
          routkb = 'A' zdelflg = '' )
    ).
    sql_test_environment->insert_test_data( i_data = item_0202 ).

    object_main->procd(
       EXPORTING
        i_bsshkb = '10'
        i_bstpkb = 'A1'
    ).
    DATA(lv_expected) = '-2500'.

    READ TABLE object_main->glb_it_okb6100
        INTO DATA(ls_okb6100)
        WITH KEY gtksym = '201412'.
    DATA(act_res) = xsdbool(
        ls_okb6100-bpurkg = lv_expected
    ).

    cl_abap_unit_assert=>assert_equals(
        act = act_res
        exp = abap_true
    ).
  ENDMETHOD.

  " 1000円
  METHOD testcase_01_59.
    prepare_testdata_set( ).

    DATA:
      act_res   TYPE p DECIMALS 2,
      lv_expted TYPE p DECIMALS 2.

    object_main->glb_it_okb6100 = VALUE #( ( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '10' ) ).

    object_main->procmr(
       EXPORTING
        i_bsmtkb = '40'
        i_bsmrkb = '10'
        i_wxbsmrsr = '-12345'
       IMPORTING
        rt_wxbsmrsr = act_res
    ).
    lv_expted = '-13000'.

    cl_abap_unit_assert=>assert_equals(
        act = act_res
        exp = lv_expted
    ).
  ENDMETHOD.


  " spkb20 -> data not found
  METHOD Testcase_02_1.
    prepare_testdata_set( ).

    DATA:
      act_res   TYPE i.
    CLEAR: object_main->glb_db_0224, object_main->glb_db_0225.

    object_main->glb_db_0224 = VALUE #( ).

    object_main->glb_db_0225 = VALUE #(
    (
    bstpkb = 'A1'
    frmndt = '201401'
    bsjkkb = '50'
    bstpsq = '0000'
    bsspkb = '10')

    ).
    object_main->spkb20( ).
    LOOP AT object_main->glb_db_0224 INTO DATA(item) WHERE frmndt <= '201401'.
      act_res = act_res + 1.
    ENDLOOP.


    cl_abap_unit_assert=>assert_equals(
    act = act_res
    exp = 0
    msg = 'ＢＰ奨励金条件マスタ not found' ).
  ENDMETHOD.

  " spkb20, wxsp20fg = '', wxsp21fg = '', wxsp30fg = ''
  METHOD Testcase_02_2.
    prepare_testdata_set( ).
    DATA:
      act_res   TYPE i,
      lv_expted TYPE i.

    lv_expted = 1.
    CLEAR: object_main->glb_db_0224, object_main->glb_db_0225.

    object_main->glb_db_0224 = VALUE #(
    ( bstpkb = 'A1' bstpnm = '旭　本番用　2014年1月から' frmndt = '201401' tomndt = '000000' bstnkb = '30' bsmrkb = '20' bsmtkb = '10' bsshkb = '10' )
    ).
    object_main->glb_db_0225 = VALUE #(
    ( bstpkb = 'A1' bsjkkb = '50' bstpnm = '旭　本番用　2014年1月から' frmndt = '201401' tomndt = '000000' bsspkb = '10' )
     ).
    object_main->spkb20( ).
    LOOP AT object_main->glb_db_0224 INTO DATA(item) WHERE frmndt <= '201401'.
      act_res = act_res + 1.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
    act = act_res
    exp = lv_expted
    msg = 'ＢＰ奨励金条件マスタ with wxsp20fg = '', wxsp21fg = '', wxsp30fg = '' ' ).
  ENDMETHOD.

  " spkb20, syokcd = 'B', wxsp20fg = 20, bpurkg = '1500', mode UP, only syokcd = 'B'
  METHOD Testcase_02_3.
    prepare_testdata_set( ).
    DATA:
      item_a251 TYPE zsdsokb6100_rt,
      item_a252 TYPE zsdsokb6100_rt.
    CLEAR: object_main->glb_db_0224, object_main->glb_db_0225.
    object_main->glb_db_0224 = VALUE #(
    ( bstpkb = 'A1' bstpnm = '旭　本番用　2014年1月から' frmndt = '201401' tomndt = '000000' bstnkb = '30' bsmrkb = '20' bsmtkb = '10' bsshkb = '10' )
      ).
    object_main->glb_db_0225 = VALUE #(
    ( bstpkb = 'A1' frmndt = '201401' bsjkkb = '50' bstpsq = '0000' bstpnm = '旭　本番用　2018年3月から' tomndt = '000000' bsspkb = '20' )
    ).
    object_main->glb_it_okb6100 = VALUE #(
    ( gtksym = '201401' egbucd = 'A251' bsgecd = '01110103' kabtkb = '08' kisokb = '10' bsgenm = '東部営業一部' bpurkm = '1500' bskart = '20' )
    ( gtksym = '201401' egbucd = 'A252' bsgecd = '01110103' kabtkb = '08' kisokb = '10' bsgenm = '東部営業二部' bpurkm = '2500' bskart = '20' )
    ).
    " wxsp20rt = 1
    DATA(exp_pre_bpsrkg_a251) = 800.
    DATA(exp_bsgenm_a251) = '東部営業一部'.
    DATA(exp_pre_bpsrkg_a252) = 0.
    DATA(exp_bsgenm_a252) = '東部営業二部'.
    object_main->spkb20( ).
    READ TABLE object_main->glb_it_okb6100 INTO item_a251 WITH KEY gtksym = '201401' kisokb = '10'  egbucd = 'A251' bsgecd = '01110103' kabtkb = '08'.
    IF sy-subrc = 0.
      DATA(act_pre_bpsrkg_a251) = item_a251-bpsrkg.
      DATA(act_bsgenm_a251) = item_a251-bsgenm.
    ELSE.
      cl_abap_unit_assert=>assert_subrc(
      act = sy-subrc
      msg = 'Data missing in item_a251'
      quit = if_aunit_constants=>quit-test ).
    ENDIF.
    READ TABLE object_main->glb_it_okb6100 INTO item_a252 WITH KEY gtksym = '201401' kisokb = '10'  egbucd = 'A252' bsgecd = '01110103' kabtkb = '08'.
    IF sy-subrc = 0.
      DATA(act_pre_bpsrkg_a252) = item_a252-bpsrkg.
      DATA(act_bsgenm_a252) = item_a252-bsgenm.
    ELSE.
      cl_abap_unit_assert=>assert_subrc(
      act = sy-subrc
      msg = 'Data missing in item_a252'
      quit = if_aunit_constants=>quit-test ).
    ENDIF.
    cl_abap_unit_assert=>assert_equals(
    act = act_pre_bpsrkg_a251
    exp = exp_pre_bpsrkg_a251
    msg = 'A251 奨励金金額 ' ).
    cl_abap_unit_assert=>assert_equals(
    act = act_bsgenm_a251
    exp = exp_bsgenm_a251
    msg = 'A251 汎用名称 ' ).
    cl_abap_unit_assert=>assert_equals(
    act = act_pre_bpsrkg_a252
    exp = exp_pre_bpsrkg_a252
    msg = 'A252 奨励金金額 ' ).
    cl_abap_unit_assert=>assert_equals(
    act = act_bsgenm_a252
    exp = exp_bsgenm_a252
    msg = 'A252 汎用名称 ' ).
  ENDMETHOD.

  " spkb20, syokcd = 'A', wxsp20fg = 20 , mode up, both syokcd = 'A, B'
  METHOD Testcase_02_4.
    prepare_testdata_set( ).
    DATA:
      item_a251 TYPE zsdsokb6100_rt,
      item_a252 TYPE zsdsokb6100_rt.
    CLEAR: object_main->glb_db_0224, object_main->glb_db_0225.
    object_main->glb_db_0224 = VALUE #(
    ( bstpkb = 'A1' bstpnm = '旭　本番用　2014年1月から' frmndt = '201401' tomndt = '000000' bstnkb = '30' bsmrkb = '20' bsmtkb = '10' bsshkb = '10' )
      ).
    object_main->glb_db_0225 = VALUE #(
    ( bstpkb = 'A1' frmndt = '201401' bsjkkb = '50' bstpsq = '0000' bstpnm = '旭　本番用　2018年3月から' tomndt = '000000' bsspkb = '20' )
    ).
    APPEND VALUE zsdt0202( bkenct = 'B25X023563' judnno = 'A252063997' jugysq = '1' egbucd = 'A252' obsycd = '55111' gbbpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸﾞ' nobpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸ'
    mubpnm = '配送料DP1：◇構造資材◇' hinmcd = '9999Z10028' sehnnm = '配送料DP1：◇構造資材◇' kabtkb = '08' syordt = '20140101' okykcd = '01110104'
    bpurtn = '2500.00' bpurkg = '1000.00'  routkb = 'A' zdelflg = ''
    ) TO object_main->glb_db_0202.
    object_main->glb_it_okb6100 = VALUE #(
    ( gtksym = '201401' egbucd = 'A251' bsgecd = '01110103' kabtkb = '08' kisokb = '10' bsgenm = '東部営業一部' bpurkm = '1500' bskart = '20' )
    ( gtksym = '201401' egbucd = 'A252' bsgecd = '01110103' kabtkb = '08' kisokb = '10' bsgenm = '東部営業二部' bpurkm = '2500' bskart = '20' )
    ).
    " wxsp20rt = 0.6
    DATA(exp_pre_bpsrkg_a251) = 480.
    DATA(exp_bsgenm_a251) = '東部営業一部'.
    DATA(exp_pre_bpsrkg_a252) = 320.
    DATA(exp_bsgenm_a252) = '東部営業二部'.
    object_main->spkb20( ).
    READ TABLE object_main->glb_it_okb6100 INTO item_a251 WITH KEY gtksym = '201401' kisokb = '10'  egbucd = 'A251' bsgecd = '01110103' kabtkb = '08'.
    IF sy-subrc = 0.
      DATA(act_pre_bpsrkg_a251) = item_a251-bpsrkg.
      DATA(act_bsgenm_a251) = item_a251-bsgenm.
    ELSE.
      cl_abap_unit_assert=>assert_subrc(
      act = sy-subrc
      msg = 'Data missing in item_a251'
      quit = if_aunit_constants=>quit-test ).
    ENDIF.
    READ TABLE object_main->glb_it_okb6100 INTO item_a252 WITH KEY gtksym = '201401' kisokb = '10'  egbucd = 'A252' bsgecd = '01110103' kabtkb = '08'.
    IF sy-subrc = 0.
      DATA(act_pre_bpsrkg_a252) = item_a252-bpsrkg.
      DATA(act_bsgenm_a252) = item_a252-bsgenm.
    ELSE.
      cl_abap_unit_assert=>assert_subrc(
      act = sy-subrc
      msg = 'Data missing in item_a252'
      quit = if_aunit_constants=>quit-test ).
    ENDIF.
    cl_abap_unit_assert=>assert_equals(
    act = act_pre_bpsrkg_a251
    exp = exp_pre_bpsrkg_a251
    msg = 'A251 奨励金金額 ' ).
    cl_abap_unit_assert=>assert_equals(
    act = act_bsgenm_a251
    exp = exp_bsgenm_a251
    msg = 'A251 汎用名称 ' ).
    cl_abap_unit_assert=>assert_equals(
    act = act_pre_bpsrkg_a252
    exp = exp_pre_bpsrkg_a252
    msg = 'A252 奨励金金額 ' ).
    cl_abap_unit_assert=>assert_equals(
    act = act_bsgenm_a252
    exp = exp_bsgenm_a252
    msg = 'A252 汎用名称 ' ).
  ENDMETHOD.

  " spkb20, syokcd = 'B', wxsp20fg = 21, bpurkg = '1500', mode UP
  METHOD Testcase_02_5.
    prepare_testdata_set( ).
    DATA:
      item_a251 TYPE zsdsokb6100_rt,
      item_a257 TYPE zsdsokb6100_rt,
      item_a252 TYPE zsdsokb6100_rt.
    CLEAR: object_main->glb_db_0224, object_main->glb_db_0225.
    object_main->glb_db_0224 = VALUE #( ( bstpkb = 'A1' bstpnm = '旭　本番用　2014年1月から' frmndt = '201401' tomndt = '000000' bstnkb = '30' bsmrkb = '20' bsmtkb = '10' bsshkb = '10' ) ).
    object_main->glb_db_0225 = VALUE #( ( bstpkb = 'A1' frmndt = '201401' bsjkkb = '50' bstpsq = '0000' bstpnm = '旭　本番用　2018年3月から' tomndt = '000000' bsspkb = '21' ) ).
    object_main->glb_it_okb6100 = VALUE #(
    ( gtksym = '201401' egbucd = 'A251' bsgecd = '01110103' kabtkb = '08' kisokb = '10' bsgenm = '東部営業一部' bpurkm = '1500' bskart = '20' )
    ( gtksym = '201401' egbucd = 'A257' bsgecd = '01110103' kabtkb = '08' kisokb = '10' bsgenm = '東部営業二部' bpurkm = '2500' bskart = '20' )
    ( gtksym = '201401' egbucd = 'A252' bsgecd = '01110103' kabtkb = '08' kisokb = '10' bsgenm = '東部営業三部' bpurkm = '5000' bskart = '20' )
    ).
    " wxsp20rt1 = 1 lt_wxsp21rt2 = 0 lt_wxsp21rt3 = 0
    DATA(exp_pre_bpsrkg_a251) = 1800.
    DATA(exp_bsgenm_a251) = '東部営業一部'.
    DATA(exp_pre_bpsrkg_a257) = 0.
    DATA(exp_bsgenm_a257) = '東部営業二部'.
    DATA(exp_pre_bpsrkg_a252) = 0.
    DATA(exp_bsgenm_a252) = '東部営業三部'.
    object_main->spkb20( ).
    READ TABLE object_main->glb_it_okb6100 INTO item_a251 WITH KEY gtksym = '201401' kisokb = '10'  egbucd = 'A251' bsgecd = '01110103' kabtkb = '08'.
    IF sy-subrc = 0.
      DATA(act_pre_bpsrkg_a251) = item_a251-bpsrkg.
      DATA(act_bsgenm_a251) = item_a251-bsgenm.
    ELSE.
      cl_abap_unit_assert=>assert_subrc(
      act = sy-subrc
      msg = 'Data missing in item_a251'
      quit = if_aunit_constants=>quit-test ).
    ENDIF.
    READ TABLE object_main->glb_it_okb6100 INTO item_a257 WITH KEY gtksym = '201401' kisokb = '10'  egbucd = 'A257' bsgecd = '01110103' kabtkb = '08'.
    IF sy-subrc = 0.
      DATA(act_pre_bpsrkg_a257) = item_a257-bpsrkg.
      DATA(act_bsgenm_a257) = item_a257-bsgenm.
    ELSE.
      cl_abap_unit_assert=>assert_subrc(
      act = sy-subrc
      msg = 'Data missing in item_a257'
      quit = if_aunit_constants=>quit-test ).
    ENDIF.
    READ TABLE object_main->glb_it_okb6100 INTO item_a252 WITH KEY gtksym = '201401' kisokb = '10'  egbucd = 'A252' bsgecd = '01110103' kabtkb = '08'.
    IF sy-subrc = 0.
      DATA(act_pre_bpsrkg_a252) = item_a252-bpsrkg.
      DATA(act_bsgenm_a252) = item_a252-bsgenm.
    ELSE.
      cl_abap_unit_assert=>assert_subrc(
      act = sy-subrc
      msg = 'Data missing in item_a252'
      quit = if_aunit_constants=>quit-test ).
    ENDIF.
    cl_abap_unit_assert=>assert_equals(
    act = act_pre_bpsrkg_a251
    exp = exp_pre_bpsrkg_a251
    msg = 'A251 奨励金金額 ' ).
    cl_abap_unit_assert=>assert_equals(
    act = act_bsgenm_a251
    exp = exp_bsgenm_a251
    msg = 'A251 汎用名称 ' ).
    cl_abap_unit_assert=>assert_equals(
    act = act_pre_bpsrkg_a257
    exp = exp_pre_bpsrkg_a257
    msg = 'A257 奨励金金額 ' ).
    cl_abap_unit_assert=>assert_equals(
    act = act_bsgenm_a252
    exp = exp_bsgenm_a252
    msg = 'A252 汎用名称 ' ).
    cl_abap_unit_assert=>assert_equals(
    act = act_pre_bpsrkg_a252
    exp = exp_pre_bpsrkg_a252
    msg = 'A252 奨励金金額 ' ).
    cl_abap_unit_assert=>assert_equals(
    act = act_bsgenm_a252
    exp = exp_bsgenm_a252
    msg = 'A252 汎用名称 ' ).
  ENDMETHOD.

  " spkb20, syokcd = 'A, B, E', wxsp20fg = 21, bpurkg = '1500', mode UP
  METHOD Testcase_02_6.
    prepare_testdata_set( ).
    DATA:
      item_a251 TYPE zsdsokb6100_rt,
      item_a257 TYPE zsdsokb6100_rt,
      item_a252 TYPE zsdsokb6100_rt.
    CLEAR: object_main->glb_db_0224, object_main->glb_db_0225.
    object_main->glb_db_0224 = VALUE #( ( bstpkb = 'A1' bstpnm = '旭　本番用　2014年1月から' frmndt = '201401' tomndt = '000000' bstnkb = '30' bsmrkb = '20' bsmtkb = '10' bsshkb = '10' ) ).
    object_main->glb_db_0225 = VALUE #( ( bstpkb = 'A1' frmndt = '201401' bsjkkb = '50' bstpsq = '0000' bstpnm = '旭　本番用　2018年3月から' tomndt = '000000' bsspkb = '21' ) ).
    APPEND VALUE zsdt0202( bkenct = 'B25X023563' judnno = 'A252063997' jugysq = '1' egbucd = 'A252' obsycd = '55111' gbbpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸﾞ' nobpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸ'
    mubpnm = '配送料DP1：◇構造資材◇' hinmcd = '9999Z10028' sehnnm = '配送料DP1：◇構造資材◇' kabtkb = '08' syordt = '20140101' okykcd = '01110104' bpurtn = '2500.00' bpurkg = '2500.00'
    routkb = 'A' zdelflg = '' ) TO object_main->glb_db_0202.
    APPEND VALUE zsdt0202( bkenct = 'B25X023563' judnno = 'A252063998' jugysq = '1' egbucd = 'A257' obsycd = '55131' gbbpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸﾞ' nobpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸ'
   mubpnm = '配送料DP1：◇構造資材◇' hinmcd = '9999Z10028' sehnnm = '配送料DP1：◇構造資材◇' kabtkb = '08' syordt = '20140101' okykcd = '01110103' bpurtn = '2500.00' bpurkg = '5000.00'
   routkb = 'A' zdelflg = '' ) TO object_main->glb_db_0202.
    object_main->glb_it_okb6100 = VALUE #(
    ( gtksym = '201401' egbucd = 'A251' bsgecd = '01110103' kabtkb = '08' kisokb = '10' bsgenm = '東部営業一部' bpurkm = '1500' bskart = '20' )
    ( gtksym = '201501' egbucd = 'A251' bsgecd = '01110105' kabtkb = '99' kisokb = '10' bsgenm = '東部営業一部' bpurkm = '1500' bskart = '20' )
    ( gtksym = '201401' egbucd = 'A257' bsgecd = '01110103' kabtkb = '08' kisokb = '10' bsgenm = '東部営業二部' bpurkm = '2500' bskart = '20' )
    ( gtksym = '201401' egbucd = 'A252' bsgecd = '01110103' kabtkb = '08' kisokb = '10' bsgenm = '東部営業三部' bpurkm = '5000' bskart = '20' )
    ).
    " wxsp20rt1 = 0.16 lt_wxsp21rt2 = 0.27 lt_wxsp21rt3 = 0.57
    DATA(exp_pre_bpsrkg_a251) = 306.
    DATA(exp_bsgenm_a251) = '東部営業一部'.
    DATA(exp_pre_bpsrkg_a257) = 504.
    DATA(exp_bsgenm_a257) = '東部営業二部'.
    DATA(exp_pre_bpsrkg_a252) = 990.
    DATA(exp_bsgenm_a252) = '東部営業三部'.
    object_main->spkb20( ).
    READ TABLE object_main->glb_it_okb6100 INTO item_a251 WITH KEY gtksym = '201401' kisokb = '10'  egbucd = 'A251' bsgecd = '01110103' kabtkb = '08'.
    IF sy-subrc = 0.
      DATA(act_pre_bpsrkg_a251) = item_a251-bpsrkg.
      DATA(act_bsgenm_a251) = item_a251-bsgenm.
    ELSE.
      cl_abap_unit_assert=>assert_subrc(
      act = sy-subrc
      msg = 'Data missing in item_a251'
      quit = if_aunit_constants=>quit-test ).
    ENDIF.
    READ TABLE object_main->glb_it_okb6100 INTO item_a257 WITH KEY gtksym = '201401' kisokb = '10'  egbucd = 'A257' bsgecd = '01110103' kabtkb = '08'.
    IF sy-subrc = 0.
      DATA(act_pre_bpsrkg_a257) = item_a257-bpsrkg.
      DATA(act_bsgenm_a257) = item_a257-bsgenm.
    ELSE.
      cl_abap_unit_assert=>assert_subrc(
      act = sy-subrc
      msg = 'Data missing in item_a257'
      quit = if_aunit_constants=>quit-test ).
    ENDIF.
    READ TABLE object_main->glb_it_okb6100 INTO item_a252 WITH KEY gtksym = '201401' kisokb = '10'  egbucd = 'A252' bsgecd = '01110103' kabtkb = '08'.
    IF sy-subrc = 0.
      DATA(act_pre_bpsrkg_a252) = item_a252-bpsrkg.
      DATA(act_bsgenm_a252) = item_a252-bsgenm.
    ELSE.
      cl_abap_unit_assert=>assert_subrc(
      act = sy-subrc
      msg = 'Data missing in item_a252'
      quit = if_aunit_constants=>quit-test ).
    ENDIF.
    cl_abap_unit_assert=>assert_equals(
    act = act_pre_bpsrkg_a251
    exp = exp_pre_bpsrkg_a251
    msg = 'A251 奨励金金額 ' ).
    cl_abap_unit_assert=>assert_equals(
    act = act_bsgenm_a251
    exp = exp_bsgenm_a251
    msg = 'A251 汎用名称 ' ).
    cl_abap_unit_assert=>assert_equals(
    act = act_pre_bpsrkg_a257
    exp = exp_pre_bpsrkg_a257
    msg = 'A257 奨励金金額 ' ).
    cl_abap_unit_assert=>assert_equals(
    exp = exp_bsgenm_a252
    act = act_bsgenm_a252
    msg = 'A252 汎用名称 ' ).
    cl_abap_unit_assert=>assert_equals(
    act = act_pre_bpsrkg_a252
    exp = exp_pre_bpsrkg_a252
    msg = 'A252 奨励金金額 ' ).
    cl_abap_unit_assert=>assert_equals(
    exp = exp_bsgenm_a252
    act = act_bsgenm_a252
    msg = 'A252 汎用名称 ' ).
  ENDMETHOD.

  " spkb20, syokcd = A wxsp20fg = 30, bpurkg = '1500', mode UP
  METHOD Testcase_02_7.
    prepare_testdata_set( ).
    DATA:
      item_a252 TYPE zsdsokb6100_rt,
      item_a253 TYPE zsdsokb6100_rt.
    CLEAR: object_main->glb_db_0224, object_main->glb_db_0225.
    object_main->glb_db_0224 = VALUE #( ( bstpkb = 'A1' bstpnm = '旭　本番用　2014年1月から' frmndt = '201401' tomndt = '000000' bstnkb = '30' bsmrkb = '20'
    bsmtkb = '10' bsshkb = '10' ) ).
    object_main->glb_db_0225 = VALUE #( ( bstpkb = 'A1' frmndt = '201401' bsjkkb = '50' bstpsq = '0000' bstpnm = '旭　本番用　2018年3月から' tomndt = '000000'
    bsspkb = '30' ) ).
    APPEND VALUE zsdt0202( bkenct = 'B25X023563' judnno = 'A252063997' jugysq = '1' egbucd = 'A252' obsycd = '55111' gbbpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸﾞ'
    nobpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸ'
    mubpnm = '配送料DP1：◇構造資材◇' hinmcd = '9999Z10028' sehnnm = '配送料DP1：◇構造資材◇' kabtkb = '08' syordt = '20140101' okykcd = '01110103' bpurtn = '2500.00' bpurkg = '2500.00'
    routkb = 'A' zdelflg = '' ) TO object_main->glb_db_0202.
    object_main->glb_it_okb6100 = VALUE #(
    ( gtksym = '201401' egbucd = 'A252' bsgecd = '01110104' kabtkb = '08' kisokb = '10' bsgenm = '部営業二部' bpurkm = '5000' bskart = '20' )
    ( gtksym = '201401' egbucd = 'A253' bsgecd = '01110104' kabtkb = '08' kisokb = '10' bsgenm = '東部営業中部' bpurkm = '2500' bskart = '20' )
    ).
    " lt_wxsp30rt = 1
    DATA(exp_pre_bpsrkg_a252) = 0.
    DATA(exp_bsgenm_a252) = '部営業二部'.
    DATA(exp_pre_bpsrkg_a253) = 1500.
    DATA(exp_bsgenm_a253) = '東部営業中部'.
    object_main->spkb20( ).
    READ TABLE object_main->glb_it_okb6100 INTO item_a252 WITH KEY gtksym = '201401' kisokb = '10'  egbucd = 'A252' bsgecd = '01110104' kabtkb = '08'.
    IF sy-subrc = 0.
      DATA(act_pre_bpsrkg_a252) = item_a252-bpsrkg.
      DATA(act_bsgenm_a252) = item_a252-bsgenm.
    ELSE.
      cl_abap_unit_assert=>assert_subrc(
      act = sy-subrc
      msg = 'Data missing in item_a252'
      quit = if_aunit_constants=>quit-test ).
    ENDIF.
    READ TABLE object_main->glb_it_okb6100 INTO item_a253 WITH KEY gtksym = '201401' kisokb = '10'  egbucd = 'A253' bsgecd = '01110104' kabtkb = '08'.
    IF sy-subrc = 0.
      DATA(act_pre_bpsrkg_a253) = item_a253-bpsrkg.
      DATA(act_bsgenm_a253) = item_a253-bsgenm.
    ELSE.
      cl_abap_unit_assert=>assert_subrc(
      act = sy-subrc
      msg = 'Data missing in item_a253'
      quit = if_aunit_constants=>quit-test ).
    ENDIF.
    cl_abap_unit_assert=>assert_equals(
    act = act_pre_bpsrkg_a252
    exp = exp_pre_bpsrkg_a252
    msg = 'A252 奨励金金額 ' ).
    cl_abap_unit_assert=>assert_equals(
    act = act_bsgenm_a252
    exp = exp_bsgenm_a252
    msg = 'A252 汎用名称 ' ).
    cl_abap_unit_assert=>assert_equals(
    act = act_pre_bpsrkg_a253
    exp = exp_pre_bpsrkg_a253
    msg = 'A253 奨励金金額 ' ).
    cl_abap_unit_assert=>assert_equals(
    act = act_bsgenm_a253
    exp = exp_bsgenm_a253
    msg = 'A253 汎用名称 ' ).
  ENDMETHOD.

  " spkb20, syokcd = A, E wxsp20fg = 30, bpurkg = '1500', mode UP
  METHOD Testcase_02_8.
    prepare_testdata_set( ).
    DATA:
      item_a252 TYPE zsdsokb6100_rt,
      item_a253 TYPE zsdsokb6100_rt.
    CLEAR: object_main->glb_db_0224, object_main->glb_db_0225.
    object_main->glb_db_0224 = VALUE #( ( bstpkb = 'A1' bstpnm = '旭　本番用　2014年1月から' frmndt = '201401' tomndt = '000000' bstnkb = '30' bsmrkb = '20' bsmtkb = '10' bsshkb = '10' ) ).
    object_main->glb_db_0225 = VALUE #( ( bstpkb = 'A1' frmndt = '201401' bsjkkb = '50' bstpsq = '0000' bstpnm = '旭　本番用　2018年3月から' tomndt = '000000' bsspkb = '30' ) ).
    APPEND VALUE zsdt0202( bkenct = 'B25X023563' judnno = 'A252063997' jugysq = '1' egbucd = 'A252' obsycd = '55111' gbbpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸﾞ' nobpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸ'
    mubpnm = '配送料DP1：◇構造資材◇' hinmcd = '9999Z10028' sehnnm = '配送料DP1：◇構造資材◇' kabtkb = '08' syordt = '20140101' okykcd = '01110104' bpurtn = '2500.00' bpurkg = '2500.00'
    routkb = 'A' zdelflg = '' ) TO object_main->glb_db_0202.
    APPEND VALUE zsdt0202( bkenct = 'B25X023563' judnno = 'A252063997' jugysq = '1' egbucd = 'A252' obsycd = '55131' gbbpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸﾞ' nobpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸ'
    mubpnm = '配送料DP1：◇構造資材◇' hinmcd = '9999Z10028' sehnnm = '配送料DP1：◇構造資材◇' kabtkb = '08' syordt = '20140101' okykcd = '01110104' bpurtn = '2500.00' bpurkg = '5500.00'
    routkb = 'A' zdelflg = '' ) TO object_main->glb_db_0202.
    object_main->glb_it_okb6100 = VALUE #(
    ( gtksym = '201401' egbucd = 'A252' bsgecd = '01110104' kabtkb = '08' kisokb = '10' bsgenm = '部営業二部' bpurkm = '5000' bskart = '20' )
    ( gtksym = '201401' egbucd = 'A253' bsgecd = '01110104' kabtkb = '08' kisokb = '10' bsgenm = '東部営業中部' bpurkm = '2500' bskart = '20' )
    ).
    " lt_wxsp30rt = 0.31
    DATA(exp_pre_bpsrkg_a252) = 465.
    DATA(exp_bsgenm_a252) = '部営業二部'.
    DATA(exp_pre_bpsrkg_a253) = 1035.
    DATA(exp_bsgenm_a253) = '東部営業中部'.
    object_main->spkb20( ).
    READ TABLE object_main->glb_it_okb6100 INTO item_a252 WITH KEY gtksym = '201401' kisokb = '10'  egbucd = 'A252' bsgecd = '01110104' kabtkb = '08'.
    IF sy-subrc = 0.
      DATA(act_pre_bpsrkg_a252) = item_a252-bpsrkg.
      DATA(act_bsgenm_a252) = item_a252-bsgenm.
    ELSE.
      cl_abap_unit_assert=>assert_subrc(
      act = sy-subrc
      msg = 'Data missing in item_a252'
      quit = if_aunit_constants=>quit-test ).
    ENDIF.
    READ TABLE object_main->glb_it_okb6100 INTO item_a253 WITH KEY gtksym = '201401' kisokb = '10'  egbucd = 'A253' bsgecd = '01110104' kabtkb = '08'.
    IF sy-subrc = 0.
      DATA(act_pre_bpsrkg_a253) = item_a253-bpsrkg.
      DATA(act_bsgenm_a253) = item_a253-bsgenm.
    ELSE.
      cl_abap_unit_assert=>assert_subrc(
      act = sy-subrc
      msg = 'Data missing in item_a253'
      quit = if_aunit_constants=>quit-test ).
    ENDIF.
    cl_abap_unit_assert=>assert_equals(
    act = act_pre_bpsrkg_a252
    exp = exp_pre_bpsrkg_a252
    msg = 'A252 奨励金金額 ' ).
    cl_abap_unit_assert=>assert_equals(
    act = act_bsgenm_a252
    exp = exp_bsgenm_a252
    msg = 'A252 汎用名称 ' ).
    cl_abap_unit_assert=>assert_equals(
    act = act_pre_bpsrkg_a253
    exp = exp_pre_bpsrkg_a253
    msg = 'A253 奨励金金額 ' ).
    cl_abap_unit_assert=>assert_equals(
    exp = exp_bsgenm_a253
    act = act_bsgenm_a253
    msg = 'A253 汎用名称 ' ).
  ENDMETHOD.

  " 検索結果が存在しない場合、method procad の処理として、仮テーブルに登録されること
  METHOD Testcase_03_1.
    prepare_testdata_set( ).

    DATA:
      act_object TYPE zsdsokb6100_rt,
      exp_object TYPE zsdsokb6100_rt.

    CLEAR: object_main->glb_it_okb6100.
    object_main->glb_it_bsge = VALUE #( ( bsgecd = '01' bsgenm = 'bsgenm' egbucd = '01' egbunm = 'egbunm' ) ).
    object_main->procad( ).
    LOOP AT object_main->glb_it_okb6100
        INTO DATA(item)
        WHERE gtksym = '201401' AND kisokb = '10' AND egbucd = '01' AND bsgecd = '01' AND kabtkb = '08'.
      IF sy-subrc = 0.
        act_object = item.
      ENDIF.
    ENDLOOP.
    exp_object = VALUE #(
        gtksym = '201401'
        egbucd = '01'
        bsgecd = '01'
        kabtkb = '08'
        kisokb = '10'
        egbunm = 'egbunm'
        bsgenm = 'bsgenm'
        bstnkb = ''
        bsmrkb = ''
        bsmtkb = ''
        kabtnm = 'OSリング'
        bskart = 0
        bpskkm = 0
        bpurkm = 0
        bpsrkm = 0
        bpskkg = 0
        bpurkg = 0
        bpsrkg = 0
    ).

    cl_abap_unit_assert=>assert_equals(
    act = act_object
    exp = exp_object
    msg = '無かったら空データ書き出し sucessful' ).
  ENDMETHOD.

  " 該当するデータが存在する場合、method procad の処理において当該レコードがスキップされること
  METHOD testcase_03_2.
    prepare_testdata_set( ).

    DATA:
      act_res           TYPE i.

    object_main->glb_it_okb6100 = VALUE #( ( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '10' ) ).
    object_main->glb_it_bsge = VALUE #( ( bsgecd = '01' bsgenm = 'bsgenm' egbucd = '01' egbunm = 'egbunm' ) ).
    object_main->procad( ).

    LOOP AT object_main->glb_it_bsge INTO DATA(item_bsge).
      LOOP AT object_main->glb_it_kabtkb INTO DATA(item_kabtkb).
        READ TABLE object_main->glb_it_okb6100 INTO DATA(item) WITH KEY gtksym = '201401' kisokb = '10'
        egbucd = item_bsge-egbucd bsgecd = item_bsge-bsgecd kabtkb = item_kabtkb-kabtkb.
        IF sy-subrc = 0.
          act_res += 1.
        ENDIF.
      ENDLOOP.
    ENDLOOP.

    cl_abap_unit_assert=>assert_not_initial(
    act = act_res
    msg = '無かったら空データ書き出し failed' ).
  ENDMETHOD.

  METHOD testcase_03_3.
    prepare_testdata_set( ).

    DATA:
      act_object_01 TYPE zsdsokb6100_rt,
      act_object_02 TYPE zsdsokb6100_rt,
      exp_object_01 TYPE zsdsokb6100_rt,
      exp_object_02 TYPE zsdsokb6100_rt.

    CLEAR: object_main->glb_it_okb6100.
    object_main->glb_it_okb6100 = VALUE #(
        ( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '10' egbunm = 'egbunm1'
            bsgenm = 'bsgenm1' bstnkb = '' bsmrkb = '' bsmtkb = '' kabtnm = 'OSリング' bskart = 20 bpskkm = 20
            bpurkm = 20 bpsrkm = 20 bpskkg = 20 bpurkg = 20 bpsrkg = 20 )
    ).
    object_main->glb_it_bsge = VALUE #(
        ( bsgecd = '01' bsgenm = 'bsgenm1' egbucd = '01' egbunm = 'egbunm1' )
        ( bsgecd = '02' bsgenm = 'bsgenm2' egbucd = '02' egbunm = 'egbunm2' )
    ).
    object_main->procad( ).
    LOOP AT object_main->glb_it_okb6100
        INTO DATA(item)
        WHERE gtksym = '201401' AND kisokb = '10' AND kabtkb = '08'.
      IF item-egbucd = '01' AND item-bsgecd = '01'.
        act_object_01 = item.
      ENDIF.
      IF item-egbucd = '02' AND item-bsgecd = '02'.
        act_object_02 = item.
      ENDIF.
    ENDLOOP.
    exp_object_01 = VALUE #(
        gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '10' egbunm = 'egbunm1'
        bsgenm = 'bsgenm1' bstnkb = '' bsmrkb = '' bsmtkb = '' kabtnm = 'OSリング' bskart = 20 bpskkm = 20
        bpurkm = 20 bpsrkm = 20 bpskkg = 20 bpurkg = 20 bpsrkg = 20
    ).
    exp_object_02 = VALUE #(
        gtksym = '201401' egbucd = '02' bsgecd = '02' kabtkb = '08' kisokb = '10' egbunm = 'egbunm2'
        bsgenm = 'bsgenm2' bstnkb = '' bsmrkb = '' bsmtkb = '' kabtnm = 'OSリング' bskart = 0 bpskkm = 0
        bpurkm = 0 bpsrkm = 0 bpskkg = 0 bpurkg = 0 bpsrkg = 0
    ).
    DATA(act_res) = xsdbool(
        act_object_01 = exp_object_01 AND act_object_02 = exp_object_02
    ).

    cl_abap_unit_assert=>assert_equals(
        act = act_res
        exp = abap_true
        msg = '無かったら空データ書き出し successful' ).
  ENDMETHOD.

  METHOD Testcase_03_4.
    prepare_testdata_set( ).

    DATA:
      act_object TYPE zsdsokb6100_rt,
      exp_object TYPE zsdsokb6100_rt.

    CLEAR: object_main->glb_it_okb6100.
    object_main->glb_startdt = '20141201'.
    object_main->glb_enddt = '20151201'.
    object_main->glb_it_bsge = VALUE #( ( bsgecd = '01' bsgenm = 'bsgenm' egbucd = '01' egbunm = 'egbunm' ) ).
    object_main->procad( ).
    LOOP AT object_main->glb_it_okb6100
        INTO DATA(item)
        WHERE gtksym = '201412' AND kisokb = '10' AND egbucd = '01' AND bsgecd = '01' AND kabtkb = '08'.
      IF sy-subrc = 0.
        act_object = item.
      ENDIF.
    ENDLOOP.
    exp_object = VALUE #(
        gtksym = '201412'
        egbucd = '01'
        bsgecd = '01'
        kabtkb = '08'
        kisokb = '10'
        egbunm = 'egbunm'
        bsgenm = 'bsgenm'
        bstnkb = ''
        bsmrkb = ''
        bsmtkb = ''
        kabtnm = 'OSリング'
        bskart = 0
        bpskkm = 0
        bpurkm = 0
        bpsrkm = 0
        bpskkg = 0
        bpurkg = 0
        bpsrkg = 0
    ).

    cl_abap_unit_assert=>assert_equals(
    act = act_object
    exp = exp_object
    msg = '無かったら空データ書き出し sucessful' ).
  ENDMETHOD.

  " 該当するデータが存在しない場合、method procsk の処理において当該レコードがスキップされること
  METHOD testcase_04_1.
    prepare_testdata_set( ).

    DATA:
      act_res           TYPE i.
    CLEAR:  object_main->glb_it_okb6100.

    object_main->glb_it_okb6100 = VALUE #( ( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '20' ) ).
    object_main->glb_it_bsge = VALUE #( ( bsgecd = '01' bsgenm = 'bsgenm' egbucd = '01' egbunm = 'egbunm' ) ).
    object_main->procsk( ).
    DATA(exp_res) = 0.
    LOOP AT object_main->glb_it_okb6100 INTO DATA(item) WHERE kisokb = '10'.
      IF sy-subrc = 0.
        act_res += 1.
      ENDIF.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
    act = act_res
    exp = exp_res
    msg = '小計データ作成 failed' ).
  ENDMETHOD.

  " 検索結果が存在する場合、method procad の処理として、仮テーブルに登録されること
  METHOD testcase_04_2.
    prepare_testdata_set( ).
    DATA:
      act_object TYPE zsdsokb6100_rt,
      exp_object TYPE zsdsokb6100_rt.
    CLEAR:  object_main->glb_it_okb6100.
    APPEND VALUE zsdsokb6100_rt( gtksym = '201401' egbucd = 'A252' bsgecd = '01' kabtkb = '08' kisokb = '10' bstnkb = '') TO object_main->glb_it_okb6100.

    object_main->procsk( ).
    exp_object = VALUE #( gtksym = '201401' egbucd = 'A252' bsgecd = '99999999' kabtkb = '08' kisokb = '20' bsgenm = '' bpurkm = '' bskart = '0' ).
    LOOP AT object_main->glb_it_okb6100 INTO DATA(item)  WHERE gtksym = '201401' AND kisokb = '20' AND egbucd = 'A252' AND bsgecd = '99999999' AND kabtkb = '08'.
      IF sy-subrc = 0.
        act_object = item.
      ENDIF.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
    act = act_object
    exp = exp_object
    msg = '小計データ作成 insert successful' ).
  ENDMETHOD.

  " procsk có data => update
  METHOD testcase_04_3.
    prepare_testdata_set( ).
    DATA:
      act_object TYPE zsdsokb6100_rt,
      exp_object TYPE zsdsokb6100_rt.
    CLEAR:  object_main->glb_it_okb6100.
    APPEND VALUE zsdsokb6100_rt( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '10' bstnkb = '10') TO object_main->glb_it_okb6100.
    APPEND VALUE zsdsokb6100_rt( gtksym = '201401' egbucd = '01' bsgecd = '99999999' kabtkb = '08' kisokb = '20' bstnkb = '20' ) TO object_main->glb_it_okb6100.

    object_main->procsk( ).
    exp_object = VALUE #( gtksym = '201401' egbucd = '01' bsgecd = '99999999' kabtkb = '08' kisokb = '20' bsgenm = '' bpurkm = '' bskart = '0' bstnkb = '10').
    LOOP AT object_main->glb_it_okb6100 INTO DATA(item) WHERE gtksym = '201401' AND kisokb = '20' AND egbucd = '01' AND bsgecd = '99999999' AND kabtkb = '08'.
      IF sy-subrc = 0.
        act_object = item.
      ENDIF.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
    act = act_object
    exp = exp_object
    msg = '小計データ作成 update successful' ).
  ENDMETHOD.

  METHOD testcase_04_4.
    prepare_testdata_set( ).
    DATA:
      act_object TYPE zsdsokb6100_rt,
      exp_object TYPE zsdsokb6100_rt.
    CLEAR:  object_main->glb_it_okb6100.
    object_main->glb_it_okb6100 = VALUE #(
        ( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '10' bstnkb = '30' bpskkg = '1500.15' bpurkg = '1500.15' bpsrkg = '1500.15'
          bskart = '0.8' bpskkm = '1500.15' bpurkm = '1500.15' bpsrkm = '1500.15' )
        ( gtksym = '201401' egbucd = '01' bsgecd = '02' kabtkb = '08' kisokb = '10' bstnkb = '30' bpskkg = '2500.25' bpurkg = '2500.25' bpsrkg = '2500.25'
          bskart = '0.9' bpskkm = '2500.25' bpurkm = '2500.25' bpsrkm = '2500.25' )
    ).

    object_main->procsk( ).
    exp_object = VALUE #(
        gtksym = '201401' egbucd = '01' bsgecd = '99999999' kabtkb = '08' kisokb = '20' bstnkb = '30' bpskkg = '4000.40' bpurkg = '4000.40' bpsrkg = '4000.40'
        bskart = '0.9' bpskkm = '4000.40' bpurkm = '4000.40' bpsrkm = '4000.40'
    ).
    LOOP AT object_main->glb_it_okb6100 INTO DATA(item) WHERE gtksym = '201401' AND kisokb = '20' AND egbucd = '01' AND bsgecd = '99999999' AND kabtkb = '08'.
      IF sy-subrc = 0.
        act_object = item.
      ENDIF.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
        act = act_object
        exp = exp_object
    ).
  ENDMETHOD.

  " procgk k có data, insert
  METHOD testcase_05_1.
    prepare_testdata_set( ).
    DATA:
      act_res TYPE i.
    CLEAR:  object_main->glb_it_okb6100.
    APPEND VALUE zsdsokb6100_rt(
        gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '20' bstnkb = '20'
    ) TO object_main->glb_it_okb6100.

    object_main->procgk( ).
    DATA(exp_res) = 1.
    LOOP AT object_main->glb_it_okb6100 INTO DATA(item) WHERE kisokb = '30'.
      IF sy-subrc = 0.
        act_res += 1.
      ENDIF.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
    act = act_res
    exp = exp_res
    msg = '総合計データ作成 insert successful' ).
  ENDMETHOD.

  " procgk có data, kabtkb = '08', update
  METHOD testcase_05_2.
    prepare_testdata_set( ).
    DATA:
      act_object TYPE zsdsokb6100_rt,
      exp_object TYPE zsdsokb6100_rt.

    CLEAR:  object_main->glb_it_okb6100.
    APPEND VALUE zsdsokb6100_rt(
        gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '20' bstnkb = '20'
    ) TO object_main->glb_it_okb6100.
    APPEND VALUE zsdsokb6100_rt(
        gtksym = '201401' egbucd = '9999' bsgecd = '99999999' kabtkb = '08' kisokb = '30' bstnkb = '30'
    ) TO object_main->glb_it_okb6100.

    exp_object = VALUE #(
        gtksym = '201401' egbucd = '9999' bsgecd = '99999999' kabtkb = '08' kisokb = '30' egbunm = '総合計' bstnkb = '20'
    ).
    object_main->procgk( ).
    DATA(exp_res) = 0.
    LOOP AT object_main->glb_it_okb6100 INTO DATA(item) WHERE kisokb = '30'.
      IF sy-subrc = 0.
        act_object = item.
      ENDIF.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
    act = act_object
    exp = exp_object
    msg = '総合計データ作成 update successful' ).
  ENDMETHOD.

  " procdm, kabtkb = '', THOÁT METHOD, " dư điều kiênj set kisokb = '30'
  METHOD testcase_06_1.
    prepare_testdata_set( ).
    DATA:
      act_object TYPE zsdsokb6100_rt,
      exp_object TYPE zsdsokb6100_rt.

    CLEAR:  object_main->glb_it_okb6100.
    object_main->glb_it_okb6100 = VALUE #( ( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '' kisokb = '30' bstnkb = '30' ) ).

    exp_object = VALUE #( ).

    object_main->procdm( ).
    LOOP AT object_main->glb_it_okb6100 INTO DATA(item) WHERE kabtkb <> ''.
      IF sy-subrc = 0.
        act_object = VALUE #( ).
      ENDIF.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
    act = act_object
    exp = exp_object
    msg = 'kabtkb is empty' ).
  ENDMETHOD.

  " procdm, kabtkb = '', insert
  METHOD testcase_06_2.
    prepare_testdata_set( ).
    DATA:
      act_object      TYPE zsdsokb6100_rt,
      exp_object      TYPE zsdsokb6100_rt,
      item_okb6100_20 TYPE zsdsokb6100_rt.

    CLEAR:  object_main->glb_it_okb6100.
    APPEND VALUE zsdsokb6100_rt(
        gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '30' bstnkb = '30'
    ) TO object_main->glb_it_okb6100.
    exp_object = VALUE #(
        gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '30' bsgenm = ''
        bpurkm = '' bskart = '0' kabtnm = '' bstnkb = '30'
    ).

    object_main->procdm( ).
    LOOP AT object_main->glb_it_okb6100 INTO DATA(item) WHERE kabtkb <> ''.
      IF sy-subrc = 0.
        act_object = item.
      ENDIF.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
    act = act_object
    exp = exp_object
    msg = '月別データ作成 insert successful' ).
  ENDMETHOD.

  " procdm, kabtkb = '', update
  METHOD testcase_06_3.
    prepare_testdata_set( ).
    DATA:
      act_object      TYPE zsdsokb6100_rt,
      exp_object      TYPE zsdsokb6100_rt,
      item_okb6100_20 TYPE zsdsokb6100_rt.

    CLEAR:  object_main->glb_it_okb6100.
    APPEND VALUE zsdsokb6100_rt( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '' kisokb = '30' bskart = '0' bstnkb = '30') TO object_main->glb_it_okb6100.
    APPEND VALUE zsdsokb6100_rt( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '30' bskart = '1' bstnkb = '30') TO object_main->glb_it_okb6100.

    exp_object = VALUE #( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '30' bskart = '1.000' kabtnm = '' bstnkb = '30' ).

    object_main->procdm( ).
    LOOP AT object_main->glb_it_okb6100 INTO DATA(item) WHERE kabtkb <> ''.
      IF sy-subrc = 0.
        act_object = item.
      ENDIF.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
    act = act_object
    exp = exp_object
    msg = '月別データ作成 update successful' ).
  ENDMETHOD.

  METHOD testcase_06_4.
    prepare_testdata_set( ).
    DATA:
      act_object      TYPE zsdsokb6100_rt,
      exp_object      TYPE zsdsokb6100_rt,
      item_okb6100_20 TYPE zsdsokb6100_rt.

    CLEAR:  object_main->glb_it_okb6100.
    APPEND VALUE zsdsokb6100_rt(
        gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '10' bstnkb = '30'
    ) TO object_main->glb_it_okb6100.
    exp_object = VALUE #(
        gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '10' bsgenm = ''
        bpurkm = '' bskart = '0' kabtnm = '' bstnkb = '30'
    ).

    object_main->procdm( ).
    LOOP AT object_main->glb_it_okb6100 INTO DATA(item) WHERE kabtkb <> ''.
      IF sy-subrc = 0.
        act_object = item.
      ENDIF.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
    act = act_object
    exp = exp_object
    msg = '月別データ作成 insert successful' ).
  ENDMETHOD.

  METHOD testcase_06_5.
    prepare_testdata_set( ).
    DATA:
      act_object      TYPE zsdsokb6100_rt,
      exp_object      TYPE zsdsokb6100_rt,
      item_okb6100_20 TYPE zsdsokb6100_rt.

    CLEAR:  object_main->glb_it_okb6100.
    APPEND VALUE zsdsokb6100_rt(
        gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '20' bstnkb = '30'
    ) TO object_main->glb_it_okb6100.
    exp_object = VALUE #(
        gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '20' bsgenm = ''
        bpurkm = '' bskart = '0' kabtnm = '' bstnkb = '30'
    ).

    object_main->procdm( ).
    LOOP AT object_main->glb_it_okb6100 INTO DATA(item) WHERE kabtkb <> ''.
      IF sy-subrc = 0.
        act_object = item.
      ENDIF.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
    act = act_object
    exp = exp_object
    msg = '月別データ作成 insert successful' ).
  ENDMETHOD.

  METHOD testcase_06_6.
    prepare_testdata_set( ).
    DATA:
      act_object      TYPE zsdsokb6100_rt,
      exp_object      TYPE zsdsokb6100_rt,
      item_okb6100_20 TYPE zsdsokb6100_rt.

    CLEAR:  object_main->glb_it_okb6100.
    APPEND VALUE zsdsokb6100_rt( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '' kisokb = '10' bskart = '0' bstnkb = '30') TO object_main->glb_it_okb6100.
    APPEND VALUE zsdsokb6100_rt( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '10' bskart = '1' bstnkb = '30') TO object_main->glb_it_okb6100.

    exp_object = VALUE #( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '10' bskart = '1.000' kabtnm = '' bstnkb = '30' ).

    object_main->procdm( ).
    LOOP AT object_main->glb_it_okb6100 INTO DATA(item) WHERE kabtkb <> ''.
      IF sy-subrc = 0.
        act_object = item.
      ENDIF.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
    act = act_object
    exp = exp_object
    msg = '月別データ作成 update successful' ).
  ENDMETHOD.

  METHOD testcase_06_7.
    prepare_testdata_set( ).
    DATA:
      act_object      TYPE zsdsokb6100_rt,
      exp_object      TYPE zsdsokb6100_rt,
      item_okb6100_20 TYPE zsdsokb6100_rt.

    CLEAR:  object_main->glb_it_okb6100.
    APPEND VALUE zsdsokb6100_rt( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '' kisokb = '20' bskart = '0' bstnkb = '30') TO object_main->glb_it_okb6100.
    APPEND VALUE zsdsokb6100_rt( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '20' bskart = '1' bstnkb = '30') TO object_main->glb_it_okb6100.

    exp_object = VALUE #( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '20' bskart = '1.000' kabtnm = '' bstnkb = '30' ).

    object_main->procdm( ).
    LOOP AT object_main->glb_it_okb6100 INTO DATA(item) WHERE kabtkb <> ''.
      IF sy-subrc = 0.
        act_object = item.
      ENDIF.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
    act = act_object
    exp = exp_object
    msg = '月別データ作成 update successful' ).
  ENDMETHOD.

  METHOD testcase_06_8.
    prepare_testdata_set( ).
    DATA:
      act_object      TYPE zsdsokb6100_rt,
      exp_object      TYPE zsdsokb6100_rt,
      item_okb6100_20 TYPE zsdsokb6100_rt.

    CLEAR:  object_main->glb_it_okb6100.
    object_main->glb_it_okb6100 = VALUE #(
        ( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '08' kisokb = '30' bstnkb = '30' bpskkg = '1500.15' bpurkg = '1500.15' bpsrkg = '1500.15'
          bpskkm = '1500.15' bpurkm = '1500.15' bpsrkm = '1500.15' )
        ( gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '02' kisokb = '30' bstnkb = '30' bpskkg = '2500.25' bpurkg = '2500.25' bpsrkg = '2500.25'
          bpskkm = '2500.25' bpurkm = '2500.25' bpsrkm = '2500.25' )
    ).
    exp_object = VALUE #(
        gtksym = '201401' egbucd = '01' bsgecd = '01' kabtkb = '' kabtnm = '月別' kisokb = '30' bstnkb = '30' bpskkg = '4000.40' bpurkg = '4000.40' bpsrkg = '4000.40'
        bpskkm = '4000.40' bpurkm = '4000.40' bpsrkm = '4000.40'
    ).

    object_main->procdm( ).
    LOOP AT object_main->glb_it_okb6100 INTO DATA(item) WHERE kabtkb = ''.
      IF sy-subrc = 0.
        act_object = item.
      ENDIF.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
        act = act_object
        exp = exp_object
    ).
  ENDMETHOD.

  " get data, param not found
  METHOD testcase_07_1.

    prepare_testdata_set(  ).
    DATA: i_param   TYPE zsds6100,
          lt_header TYPE TABLE FOR ACTION RESULT zr_sd_0351~get_data,
          act_res   TYPE i.
    i_param = VALUE #(
        iv_bstpkb = ''
        iv_frmndt = ''
    ).
    object_main->get_data(
    EXPORTING
        keys = VALUE #( ( %cid = '' %param = i_param ) )
     CHANGING
            result = lt_header
    ).

    object_main->get_data(  ).
    LOOP AT object_main->glb_it_okb6100 INTO DATA(item).
      act_res = act_res + 1.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
      act = act_res
      exp = 0
      msg = 'Result should be empty when keys is empty'
      quit = if_aunit_constants=>quit-test
      ).

  ENDMETHOD.

  " get data,
  METHOD testcase_07_2.

    prepare_testdata_set(  ).
    DATA: i_param   TYPE zsds6100,
          lt_header TYPE TABLE FOR ACTION RESULT zr_sd_0351~get_data,
          act_res   TYPE i.
    i_param = VALUE #(
        iv_bstpkb = 'A1'
        iv_frmndt = '201401'
    ).
    object_main->get_data(
    EXPORTING
        keys = VALUE #( ( %cid = '' %param = i_param ) )
     CHANGING
            result = lt_header
    ).

    object_main->get_data(  ).
    LOOP AT object_main->glb_it_okb6100 INTO DATA(item) WHERE gtksym = '201401' AND egbucd = 'A251' AND kisokb = '10'.
      act_res = act_res + 1.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
      act = act_res
      exp = 8
      msg = 'Confirm that the number of records returned that satisfy the filter conditions.'
      quit = if_aunit_constants=>quit-test
      ).

  ENDMETHOD.

  METHOD prepare_testdata_item0225.
    sql_test_environment->clear_doubles( ).
    CREATE OBJECT object_main FOR TESTING.
    CLEAR:
  object_main->glb_db_0224,
  object_main->glb_db_0225,
  object_main->glb_db_makt,
  object_main->glb_db_tvkbt,
  object_main->glb_it_okb6100,
  object_main->glb_db_0209,
  object_main->glb_startdt,
  object_main->glb_in_bsshkb,
  object_main->glb_it_kabtkb,
  object_main->glb_enddt.

    DATA:
      item_0202 TYPE STANDARD TABLE OF zsdt0202 WITH EMPTY KEY,
      item_0224 TYPE STANDARD TABLE OF zsdt0224 WITH EMPTY KEY,
      item_0210 TYPE STANDARD TABLE OF zsdt0210 WITH EMPTY KEY,
      item_0225 TYPE STANDARD TABLE OF zsdt0225 WITH EMPTY KEY,
      startdate TYPE dats,
      enddate   TYPE dats.

    startdate = '20140101'.
    enddate = '20150101'.
    object_main->glb_startdt = startdate.
    object_main->glb_enddt = enddate.


    object_main->glb_db_0209 = VALUE #(
    (
   hdbucd = 'DP1'
   hcbucd = 'DP11130'
   hsbucd = 'DP111301130'
   kabtkb = '08'
   kabtnm = 'OSリング'
   bnrikb = ''
   bunrnm = ''
   zdelflg = ''
    )
    ).

    object_main->glb_db_0224 = VALUE #(
     ( bstpkb = 'A1' bstpnm = '旭　本番用　2014年1月から' frmndt = '201401' tomndt = '000000' bstnkb = '30' bsmrkb = '20' bsmtkb = '10' bsshkb = '10' )

      ).

    object_main->glb_db_0225 = VALUE #(
    ( client = '310'
    bstpkb = 'A1'
    frmndt = '201401'
    bsjkkb = '20'
    bstpsq = '0000'
    bstpnm = '旭　本番用　2018年3月から'
    tomndt = '000000'
    rtchkb = ''  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
    bsjnkb = '10'  bsjnnm = '配送料DP1：◇構造資材◇'  bsksfg = ''
    obks01 = ''  obks02 = ''  obks03 = ''  obks04 = 'obks01'  obks05 = 'obks01'
    obks06 = ''  obks07 = ''  obks08 = ''  obks09 = ''  obks10 = ''
    okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = ''
    okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = ''
    bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
    obkrcd = ''  okkrcd = ''  kkrhkb = ''
    bskart = '0.000'
    zdelflg = '' )

    ( client = '310'
    bstpkb = 'A1'
    frmndt = '201401'
    bsjkkb = '10'
    bstpsq = '0001'
    bstpnm = '旭　本番用　2018年3月から'
    tomndt = '000000'
    rtchkb = 'A'  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
    bsjnkb = '20'  bsjnnm = '配送料DP1：◇構造資材◇'  bsksfg = ''
    obks01 = 'obks01'  obks02 = 'obks01'  obks03 = 'obks01'  obks04 = 'obks01'  obks05 = 'obks01'
    obks06 = ''  obks07 = ''  obks08 = ''  obks09 = ''  obks10 = ''
    okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = ''
    okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = ''
    bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
    obkrcd = ''  okkrcd = ''  kkrhkb = ''
    bskart = '0.000'
    zdelflg = '' )

    ( client = '310'
    bstpkb = 'A1'
    frmndt = '201401'
    bsjkkb = '10'
    bstpsq = '0002'
    bstpnm = '旭　本番用　2018年3月から'
    tomndt = '000000'
    rtchkb = 'A'  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
    bsjnkb = '30'  bsjnnm = '配送料DP1'  bsksfg = ''
    obks01 = 'obks01'  obks02 = 'obks01'  obks03 = 'obks01'  obks04 = 'obks01'  obks05 = 'obks01'
    obks06 = ''  obks07 = ''  obks08 = ''  obks09 = ''  obks10 = ''
    okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = ''
    okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = ''
    bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
    obkrcd = ''  okkrcd = ''  kkrhkb = ''
    bskart = '0.000'
    zdelflg = '' )

    ( client = '310'
    bstpkb = 'A1'
    frmndt = '201401'
    bsjkkb = '10'
    bstpsq = '0003'
    bstpnm = '旭　本番用　2018年3月から'
    tomndt = '000000'
    rtchkb = 'A'  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
    bsjnkb = '40'  bsjnnm = '配送料DP1：◇構造資材◇'  bsksfg = ''
    obks01 = 'obks01'  obks02 = 'obks01'  obks03 = 'obks01'  obks04 = 'obks01'  obks05 = 'obks01'
    obks06 = ''  obks07 = ''  obks08 = ''  obks09 = ''  obks10 = ''
    okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = ''
    okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = ''
    bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
    obkrcd = ''  okkrcd = ''  kkrhkb = ''
    bskart = '0.000'
    zdelflg = '' )

    ( client = '310'
    bstpkb = 'A1'
    frmndt = '201401'
    bsjkkb = '30'
    bstpsq = '0003'
    bstpnm = '旭　本番用　2018年3月から'
    tomndt = '000000'
    rtchkb = 'A'  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
    bsjnkb = '40'  bsjnnm = '配送料DP1：◇構造資材◇'  bsksfg = ''
    obks01 = '55113'  obks02 = '55113'  obks03 = '55113'  obks04 = '55113'  obks05 = '55113'
    obks06 = '55113'  obks07 = '55113'  obks08 = '55113'  obks09 = '55113'  obks10 = '55113'
    okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = ''
    okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = ''
    bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
    obkrcd = ''  okkrcd = ''  kkrhkb = ''
    bskart = '0.000'
    zdelflg = '' )

    ( client = '310'
    bstpkb = 'A1'
    frmndt = '201401'
    bsjkkb = '40'
    bstpsq = '0000'
    bstpnm = '旭　本番用　2018年3月から'
    tomndt = '000000'
    bsspkb = '21'
    rtchkb = 'A'  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
    bsjnkb = '10'  bsjnnm = '配送料DP1：◇構造資材◇'  bsksfg = ''
    obks01 = 'obks01'  obks02 = 'obks01'  obks03 = 'obks01'  obks04 = 'obks01'  obks05 = 'obks01'
    obks06 = ''  obks07 = ''  obks08 = ''  obks09 = ''  obks10 = ''
    okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = ''
    okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = ''
    bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
    obkrcd = ''  okkrcd = ''  kkrhkb = '08'
    bskart = '0.000'
    zdelflg = '' )

    ( client = '310'
    bstpkb = 'A1'
    frmndt = '201401'
    bsjkkb = ''
    bstpsq = '0000'
    bstpnm = '旭　本番用　2018年3月から'
    tomndt = '000000'
    bsspkb = '30'
    rtchkb = 'A'  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
    bsjnkb = '10'  bsjnnm = '配送料DP1：◇構造資材◇'  bsksfg = ''
    obks01 = 'obks01'  obks02 = 'obks01'  obks03 = 'obks01'  obks04 = 'obks01'  obks05 = 'obks01'
    obks06 = ''  obks07 = ''  obks08 = ''  obks09 = ''  obks10 = ''
    okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = ''
    okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = ''
    bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
    obkrcd = ''  okkrcd = ''  kkrhkb = '08'
    bskart = ''
    zdelflg = '' )
    ).

    object_main->glb_db_0202 = VALUE #(

    (
     bkenct = 'B25X023563'
     judnno = 'A252063997'
     jugysq = '1'
     ykjono = ''
     hbsocd = 'A000'
     rtchcd = '00'
     shnbcd = '00'
     sitncd = 'A25'
     egbucd = 'A252'
     obsycd = '55113'
     obsynm = '埼玉A'
     jdbrno = 'A2'
     skpocd = ''
     bkenno = ''
     hnsycd = ''
     gbbpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸﾞ'
     gadrcd = '11101'
     gadscd = '11'
     gabpnm = ''
     nobpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸ'
     noadcd = ''
     nabpnm = ''
     notlno = ''
     kuixkb = ''
     gtytcd = ''
     gtytnm = ''
     tkykcd = '1172'
     tkkjnm = '所沢資材'
     sktncd = 'ZZZZ'
     skkjnm = '　'
     gtkstx = ''
     mubpnm = '配送料DP1：◇構造資材◇'
     jbkotx = ''
     hinmcd = '9999Z10028'
     sehnnm = '配送料DP1：◇構造資材◇'
     syuksr = '1'
     bpjysr = '0'
     ksunst = '0'
     bpsktn = '0.00'
     bpskkg = '0.00'
     juchdt = '20140320'
     bpnodt = '20140315'
     hdbucd = 'DP1'
     hcbucd = 'DP19999'
     hsbucd = 'DP199999999'
     kabtkb = '08'
     bnrikb = '90'
     senucd = ''
     senunm = ''
     kyakcd = ''
     kyaknm = ''
     icmpnm = ''
     iadrcd = ''
     iabpnm = ''
     itelno = ''
     kkbpnm = ''
     kzadcd = ''
     kzadnm = ''
     kztlno = ''
     sysxdt = '20140321'
     syordt = '20140101'
     okykcd = '01110103'
     okyknm = '旭　東京'
     bpurtn = '1500.00'
     bpurkg = '1500.00'
     juchcd = '107480103B'
     msercd = ''
     bpjtdt = '20140321'
     gtksdt = '20140331'
     routkb = 'A'
     kbtjdt = '0'
     zdelflg = ''
     zaedat = '20251014'
     created_by = ''
     created_at = '0.0000000'
     last_changed_by = ''
     local_last_changed_at = '0.0000000'
     last_changed_at = '0.0000000'
     ) ).

    object_main->glb_db_tvkbt = VALUE #(
    ( vkbur = 'A252'
    spras = 'J'
    bezei = '東部営業二部' )
     ).

    object_main->glb_it_kabtkb = VALUE #(
    ( kabtkb = '02' kabtnm = 'Ⅰ型V' )
    ( kabtkb = '03' kabtnm = 'Ⅱ型' )
    ( kabtkb = '04' kabtnm = '円型' )
    ( kabtkb = '05' kabtnm = 'NT' )
    ( kabtkb = '06' kabtnm = 'P3' )
    ( kabtkb = '07' kabtnm = 'Hz' )
    ).

    object_main->glb_db_makt = VALUE #(
    ( spras = 'J'
    maktx = '配送料DP1：◇構造資材◇'
    maktg = '配送料DP1：◇構造資材◇'
    matnr = '9999Z10028' )
    ).


    " Insert test data for zsdt0210
    item_0210 = VALUE #(
     ( obsycd = '55113'
      okykcd = '01110103'
      syokcd = 'B'
     )
     ( obsycd = '55111'
      okykcd = '01110104'
      syokcd = 'A'
     )
     ( obsycd = '55131'
      okykcd = '01110104'
      syokcd = 'C'
     )
     ( obsycd = '55131'
      okykcd = '01110103'
      syokcd = 'E'
     )
     ( obsycd = '55114'
      okykcd = '01110103'
      syokcd = 'A'
     )
     ).

    " Insert test data for zsdt0202
    item_0202 = VALUE #(
    (
     bkenct = 'B25X023563'
     judnno = 'A252063997'
     jugysq = '1'
     hbsocd = 'A000'
     rtchcd = '00'
     shnbcd = '00'
     sitncd = 'A25'
     egbucd = 'A252'
     obsycd = '55113'
     obsynm = '埼玉A'
     jdbrno = 'A2'
     gbbpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸﾞ'
     gadrcd = '11101'
     gadscd = '11'
     nobpnm = '所沢資材/ｱｷﾃｯｸ/OSﾘﾝｸ'
     tkykcd = '1172'
     tkkjnm = '所沢資材'
     sktncd = 'ZZZZ'
     mubpnm = '配送料DP1：◇構造資材◇'
     hinmcd = '9999Z10028'
     sehnnm = '配送料DP1：◇構造資材◇'
     syuksr = '1'
     bpjysr = '0'
     ksunst = '0'
     bpsktn = '0.00'
     bpskkg = '0.00'
     juchdt = '20140320'
     bpnodt = '20140315'
     hdbucd = 'DP1'
     hcbucd = 'DP19999'
     hsbucd = 'DP199999999'
     kabtkb = '08'
     bnrikb = '90'
     sysxdt = '20140321'
     syordt = '20140101'
     okykcd = '01110103'
     okyknm = '旭　東京'
     bpurtn = '1500.00'
     bpurkg = '1200.00'
     juchcd = '107480103B'
     bpjtdt = '20140321'
     gtksdt = '20140331'
     routkb = 'A'
     zdelflg = ''
     )

    ).
    item_0224 = VALUE #(
    ( bstpkb = 'A1' bstpnm = '旭　本番用　2014年1月から' frmndt = '201401' tomndt = '000000' bstnkb = '30' bsmrkb = '20' bsmtkb = '10' bsshkb = '10' )
    ( bstpkb = 'A1' bstpnm = '旭　本番用　2014年1月から' frmndt = '201203' tomndt = '000000' bstnkb = '30' bsmrkb = '20' bsmtkb = '10' bsshkb = '20' )
    ( bstpkb = 'A1' bstpnm = '旭　本番用　2014年1月から' frmndt = '201311' tomndt = '000000' bstnkb = '30' bsmrkb = '20' bsmtkb = '10' bsshkb = '30' )
    ( bstpkb = 'A1' bstpnm = '旭　本番用　2014年1月から' frmndt = '201310' tomndt = '000000' bstnkb = '30' bsmrkb = '20' bsmtkb = '10' bsshkb = '40' )
    ( bstpkb = 'A1' bstpnm = '旭　本番用　2014年1月から' frmndt = '201510' tomndt = '000000' bstnkb = '30' bsmrkb = '20' bsmtkb = '10' bsshkb = '40' )
     ).

    item_0225 = VALUE #(
    ( bstpkb = 'A1' bsjkkb = '50' bstpnm = '旭　本番用　2014年1月から' frmndt = '201401' tomndt = '000001' bsspkb = '10' )
    ( bstpkb = 'A1' frmndt = '201401' bsjkkb = '50' bstpsq = '0001' bstpnm = '旭　本番用　2018年3月から' tomndt = '000002' bsspkb = '20' )
    ( bstpkb = 'A1' frmndt = '201401' bsjkkb = '50' bstpsq = '0002' bstpnm = '旭　本番用　2018年3月から' tomndt = '000003' bsspkb = '21' )
    ( bstpkb = 'A1' frmndt = '201401' bsjkkb = '50' bstpsq = '0003' bstpnm = '旭　本番用　2018年3月から' tomndt = '000004' bsspkb = '30' )

    ( client = '310'
    bstpkb = 'A1'
    frmndt = '201401'
    bsjkkb = '10'
    bstpsq = '0001'
    bstpnm = '旭　本番用　2018年3月から'
    tomndt = '000000'
    rtchkb = 'A'  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
    bsjnkb = '20'  bsjnnm = '配送料DP1：◇構造資材◇'  bsksfg = ''
    obks01 = 'obks01'  obks02 = 'obks01'  obks03 = 'obks01'  obks04 = 'obks01'  obks05 = 'obks01'
    obks06 = ''  obks07 = ''  obks08 = ''  obks09 = ''  obks10 = ''
    okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = ''
    okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = ''
    bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
    obkrcd = ''  okkrcd = ''  kkrhkb = ''
    bskart = '0.000'
    zdelflg = '' )

    ( client = '310'
    bstpkb = 'A1'
    frmndt = '201401'
    bsjkkb = '10'
    bstpsq = '0002'
    bstpnm = '旭　本番用　2018年3月から'
    tomndt = '000000'
    rtchkb = 'A'  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
    bsjnkb = '30'  bsjnnm = '配送料DP1'  bsksfg = ''
    obks01 = 'obks01'  obks02 = 'obks01'  obks03 = 'obks01'  obks04 = 'obks01'  obks05 = 'obks01'
    obks06 = ''  obks07 = ''  obks08 = ''  obks09 = ''  obks10 = ''
    okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = ''
    okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = ''
    bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
    obkrcd = ''  okkrcd = ''  kkrhkb = ''
    bskart = '0.000'
    zdelflg = '' )

    ( client = '310'
    bstpkb = 'A1'
    frmndt = '201401'
    bsjkkb = '10'
    bstpsq = '0003'
    bstpnm = '旭　本番用　2018年3月から'
    tomndt = '000000'
    rtchkb = 'A'  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
    bsjnkb = '40'  bsjnnm = '配送料DP1：◇構造資材◇'  bsksfg = ''
    obks01 = 'obks01'  obks02 = 'obks01'  obks03 = 'obks01'  obks04 = 'obks01'  obks05 = 'obks01'
    obks06 = ''  obks07 = ''  obks08 = ''  obks09 = ''  obks10 = ''
    okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = ''
    okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = ''
    bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
    obkrcd = ''  okkrcd = ''  kkrhkb = ''
    bskart = '0.000'
    zdelflg = '' )

    ).

    sql_test_environment->insert_test_data( i_data = item_0202 ).
    sql_test_environment->insert_test_data( i_data = item_0210 ).
    sql_test_environment->insert_test_data( i_data = item_0224 ).
    sql_test_environment->insert_test_data( i_data = item_0225 ).

  ENDMETHOD.

  METHOD testcase_07_3.
 prepare_testdata_set( ).
      CLEAR: object_main->glb_db_0225.

     DATA: act_res type i.
     TEST-INJECTION item_0225_not_found.
    glb_db_0225 = VALUE #( ( bstpkb = 'A1' frmndt = '201401' bsjkkb = '20' bstpsq = '0000' bstpnm = '旭　本番用　2018年3月から' tomndt = '000000' rtchkb = ''  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
    bsjnkb = '10'  bsjnnm = '配送料DP1：◇構造資材◇'  bsksfg = '' obks01 = 'obks01'  obks02 = 'obks01'  obks03 = 'obks01'  obks04 = 'obks01'  obks05 = 'obks01' obks06 = ''  obks07 = ''  obks08 = ''  obks09 = ''  obks10 = ''
    okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = '' okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = '' bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
    obkrcd = ''  okkrcd = ''  kkrhkb = ''
    bskart = '0.000'
    zdelflg = '' ) ).
    END-TEST-INJECTION.
    " glb_in_bsshkb = 50
    object_main->chkprm(
     EXPORTING
       i_bsshkb    = '10'        " 奨励金集約区分
       i_frmndt    = '201401'    " 適用月度FROM
   ).
    object_main->procd(
     EXPORTING
       i_bsshkb    = '10'        " 奨励金集約区分
       i_bstpkb    = 'A1'        " 奨励金タイプ
   ).

    LOOP AT object_main->glb_it_okb6100 INTO DATA(item) WHERE gtksym = '201401' AND kabtkb = '08' AND kisokb = '10'.
      act_res = act_res + 1.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
      act = act_res
      exp = 0
      msg = 'Verify the processing when there is no data that meets the exclusion conditions.'
      quit = if_aunit_constants=>quit-test
      ).
  ENDMETHOD.
    METHOD testcase_07_4.

      prepare_testdata_set( ).
      CLEAR: object_main->glb_db_0225.

     DATA: act_res type i.
     TEST-INJECTION item_0225_not_found.
    glb_db_0225 = VALUE #( ( bstpkb = 'A1' frmndt = '201401' bsjkkb = '10' bstpsq = '0000' bstpnm = '旭　本番用　2018年3月から' tomndt = '000000' rtchkb = 'A'  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
    bsjnkb = '10'  bsjnnm = '配送料DP1：◇構造資材◇'  bsksfg = '' obks01 = 'obks01'  obks02 = 'obks01'  obks03 = 'obks01'  obks04 = 'obks01'  obks05 = 'obks01' obks06 = ''  obks07 = ''  obks08 = ''  obks09 = ''  obks10 = ''
    okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = '' okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = '' bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
    obkrcd = ''  okkrcd = ''  kkrhkb = ''
    bskart = '0.000'
    zdelflg = '' )
    ( bstpkb = 'A1' frmndt = '201401' bsjkkb = '20' bstpsq = '0000' bstpnm = '旭　本番用　2018年3月から' tomndt = '000000' rtchkb = 'A'  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
    bsjnkb = '10'  bsjnnm = '配送料DP1：◇構造資材◇'  bsksfg = '' obks01 = 'obks01'  obks02 = 'obks01'  obks03 = 'obks01'  obks04 = 'obks01'  obks05 = 'obks01' obks06 = ''  obks07 = ''  obks08 = ''  obks09 = ''  obks10 = ''
    okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = '' okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = '' bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
    obkrcd = ''  okkrcd = ''  kkrhkb = ''
    bskart = '0.000'
    zdelflg = '' )
    ( bstpkb = 'A1' frmndt = '201401' bsjkkb = '30' bstpsq = '0000' bstpnm = '旭　本番用　2018年3月から' tomndt = '000000' rtchkb = ''  kachkb = '08'  obchcd = '55113'  okchcd = '01110103'
    bsjnkb = '10'  bsjnnm = '配送料DP1：◇構造資材◇'  bsksfg = '' obks01 = 'obks01'  obks02 = 'obks01'  obks03 = 'obks01'  obks04 = 'obks01'  obks05 = 'obks01' obks06 = ''  obks07 = ''  obks08 = ''  obks09 = ''  obks10 = ''
    okks01 = '01110103'  okks02 = ''  okks03 = ''  okks04 = ''  okks05 = '' okks06 = ''  okks07 = ''  okks08 = ''  okks09 = ''  okks10 = '' bskscd = ''  bsksnm = ''  ebkscd = 'A252'  ebkrcd = ''
    obkrcd = ''  okkrcd = ''  kkrhkb = ''
    bskart = '0.000'
    zdelflg = '' ) ).
    END-TEST-INJECTION.
    " glb_in_bsshkb = 50
    object_main->chkprm(
     EXPORTING
       i_bsshkb    = '10'        " 奨励金集約区分
       i_frmndt    = '201401'    " 適用月度FROM
   ).
    object_main->procd(
     EXPORTING
       i_bsshkb    = '10'        " 奨励金集約区分
       i_bstpkb    = 'A1'        " 奨励金タイプ
   ).
    LOOP AT object_main->glb_it_okb6100 INTO DATA(item) WHERE gtksym = '201401' AND kabtkb = '08' AND kisokb = '10'.
      act_res = act_res + 1.
    ENDLOOP.

    cl_abap_unit_assert=>assert_equals(
      act = act_res
      exp = 0
      msg = 'Verify the processing when there is no data that meets the exclusion conditions.'
      quit = if_aunit_constants=>quit-test
      ).
ENDMETHOD.
  METHOD testcase_08_1.
    prepare_testdata_set(  ).
    " glb_in_bsshkb = 50
    object_main->chkprm(
     EXPORTING
       i_bsshkb    = '10'        " 奨励金集約区分
       i_frmndt    = '201401'    " 適用月度FROM
   ).

    cl_abap_unit_assert=>assert_equals(
      act = object_main->glb_in_bsshkb
      exp = '50'
      msg = 'Verify that the incentive rounding unit is correctly applied per department.'
      quit = if_aunit_constants=>quit-test
      ).
  ENDMETHOD.

  METHOD testcase_08_2.
    prepare_testdata_set(  ).
    " glb_in_bsshkb = 51
    object_main->chkprm(
     EXPORTING
       i_bsshkb    = '20'        " 奨励金集約区分
       i_frmndt    = '201401'    " 適用月度FROM
   ).

    cl_abap_unit_assert=>assert_equals(
      act = object_main->glb_in_bsshkb
      exp = '51'
      msg = 'Verify that the incentive rounding unit is correctly applied per customer.'
      quit = if_aunit_constants=>quit-test
      ).
  ENDMETHOD.

  METHOD testcase_08_3.
    prepare_testdata_set(  ).
    " glb_in_bsshkb = 52
    object_main->chkprm(
     EXPORTING
       i_bsshkb    = '30'        " 奨励金集約区分
       i_frmndt    = '201401'    " 適用月度FROM
   ).

    cl_abap_unit_assert=>assert_equals(
      act = object_main->glb_in_bsshkb
      exp = '52'
      msg = 'Verify that the incentive rounding unit is correctly applied per special construction type.'
      quit = if_aunit_constants=>quit-test
      ).
  ENDMETHOD.

  METHOD testcase_08_4.
    prepare_testdata_set(  ).
    " glb_in_bsshkb = 53
    object_main->chkprm(
     EXPORTING
       i_bsshkb    = '40'        " 奨励金集約区分
       i_frmndt    = '201401'    " 適用月度FROM
   ).

    cl_abap_unit_assert=>assert_equals(
      act = object_main->glb_in_bsshkb
      exp = '53'
      msg = 'Verify that the incentive rounding unit is correctly applied per prefecture'
      quit = if_aunit_constants=>quit-test
      ).
  ENDMETHOD.

  METHOD testcase_08_5.
    prepare_testdata_set(  ).
    " glb_in_bsshkb = 53
    object_main->chkprm(
     EXPORTING
       i_bsshkb    = '40'        " 奨励金集約区分
       i_frmndt    = '201401'    " 適用月度FROM
   ).

    cl_abap_unit_assert=>assert_equals(
      act = object_main->glb_startdt
      exp = '20140101'
      msg = 'Verify that the start date is retrieved correctly.'
      quit = if_aunit_constants=>quit-test
      ).
    cl_abap_unit_assert=>assert_equals(
     act = object_main->glb_enddt
     exp = '20150101'
     msg = 'Verify that the end date is retrieved correctly.'
     quit = if_aunit_constants=>quit-test
     ).
  ENDMETHOD.

  METHOD testcase_08_6.
    prepare_testdata_set(  ).
    object_main->chkprm(
     EXPORTING
       i_bsshkb    = '50'        " 奨励金集約区分
       i_frmndt    = '201401'    " 適用月度FROM
   ).

    cl_abap_unit_assert=>assert_equals(
      act = object_main->glb_in_bsshkb
      exp = ''
      ).
  ENDMETHOD.
ENDCLASS.